(function(window,undefined){function require(arg){return window.less[arg.split("/")[1]]}if(!Array.isArray){Array.isArray=function(obj){return Object.prototype.toString.call(obj)==="[object Array]"||(obj instanceof Array)}}if(!Array.prototype.forEach){Array.prototype.forEach=function(block,thisObject){var len=this.length>>>0;for(var i=0;i<len;i++){if(i in this){block.call(thisObject,this[i],i,this)}}}}if(!Array.prototype.map){Array.prototype.map=function(fun){var len=this.length>>>0;var res=new Array(len);var thisp=arguments[1];for(var i=0;i<len;i++){if(i in this){res[i]=fun.call(thisp,this[i],i,this)}}return res}}if(!Array.prototype.filter){Array.prototype.filter=function(block){var values=[];var thisp=arguments[1];for(var i=0;i<this.length;i++){if(block.call(thisp,this[i])){values.push(this[i])}}return values}}if(!Array.prototype.reduce){Array.prototype.reduce=function(fun){var len=this.length>>>0;var i=0;if(len===0&&arguments.length===1){throw new TypeError()}if(arguments.length>=2){var rv=arguments[1]}else{do{if(i in this){rv=this[i++];break}if(++i>=len){throw new TypeError()}}while(true)}for(;i<len;i++){if(i in this){rv=fun.call(null,rv,this[i],i,this)}}return rv}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(value){var length=this.length;var i=arguments[1]||0;if(!length){return -1}if(i>=length){return -1}if(i<0){i+=length}for(;i<length;i++){if(!Object.prototype.hasOwnProperty.call(this,i)){continue}if(value===this[i]){return i}}return -1}}if(!Object.keys){Object.keys=function(object){var keys=[];for(var name in object){if(Object.prototype.hasOwnProperty.call(object,name)){keys.push(name)}}return keys}}if(!String.prototype.trim){String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}var less,tree;if(typeof environment==="object"&&({}).toString.call(environment)==="[object Environment]"){less={};tree=less.tree={};less.mode="rhino"}else{if(typeof(window)==="undefined"){less=exports,tree=require("./tree");less.mode="node"}else{if(typeof(window.less)==="undefined"){window.less={}}less=window.less,tree=window.less.tree={};less.mode="browser"}}less.Parser=function Parser(env){var input,i,j,temp,memo,furthest,chunks,current,parser;var that=this;var finish=function(){};var imports=this.imports={paths:env&&env.paths||[],queue:[],files:{},mime:env&&env.mime,push:function(path,callback){var that=this;this.queue.push(path);less.Parser.importer(path,this.paths,function(root){that.queue.splice(that.queue.indexOf(path),1);that.files[path]=root;callback(root);if(that.queue.length===0){finish()}},env)}};function save(){temp=chunks[j],memo=i,current=i}function restore(){chunks[j]=temp,i=memo,current=i}function sync(){if(i>current){chunks[j]=chunks[j].slice(i-current);current=i}}function $(tok){var match,args,length,c,index,endIndex,k,mem;if(tok instanceof Function){return tok.call(parser.parsers)}else{if(typeof(tok)==="string"){match=input.charAt(i)===tok?tok:null;length=1;sync()}else{sync();if(match=tok.exec(chunks[j])){length=match[0].length}else{return null}}}if(match){mem=i+=length;endIndex=i+chunks[j].length-length;while(i<endIndex){c=input.charCodeAt(i);if(!(c===32||c===10||c===9)){break}i++}chunks[j]=chunks[j].slice(length+(i-mem));current=i;if(chunks[j].length===0&&j<chunks.length-1){j++}if(typeof(match)==="string"){return match}else{return match.length===1?match[0]:match}}}function peek(tok){if(typeof(tok)==="string"){return input.charAt(i)===tok}else{if(tok.test(chunks[j])){return true}else{return false}}}this.env=env=env||{};this.optimization=("optimization" in this.env)?this.env.optimization:1;this.env.filename=this.env.filename||null;return parser={imports:imports,parse:function(str,callback){var root,start,end,zone,line,lines,buff=[],c,error=null;i=j=current=furthest=0;chunks=[];input=str.replace(/\r\n/g,"\n");chunks=(function(chunks){var j=0,skip=/[^"'`\{\}\/\(\)]+/g,comment=/\/\*(?:[^*]|\*+[^\/*])*\*+\/|\/\/.*/g,level=0,match,chunk=chunks[0],inParam,inString;for(var i=0,c,cc;i<input.length;i++){skip.lastIndex=i;if(match=skip.exec(input)){if(match.index===i){i+=match[0].length;chunk.push(match[0])}}c=input.charAt(i);comment.lastIndex=i;if(!inString&&!inParam&&c==="/"){cc=input.charAt(i+1);if(cc==="/"||cc==="*"){if(match=comment.exec(input)){if(match.index===i){i+=match[0].length;chunk.push(match[0]);c=input.charAt(i)}}}}if(c==="{"&&!inString&&!inParam){level++;chunk.push(c)}else{if(c==="}"&&!inString&&!inParam){level--;chunk.push(c);chunks[++j]=chunk=[]}else{if(c==="("&&!inString&&!inParam){chunk.push(c);inParam=true}else{if(c===")"&&!inString&&inParam){chunk.push(c);inParam=false}else{if(c==='"'||c==="'"||c==="`"){if(!inString){inString=c}else{inString=inString===c?false:inString}}chunk.push(c)}}}}}if(level>0){throw {type:"Syntax",message:"Missing closing `}`",filename:env.filename}}return chunks.map(function(c){return c.join("")})})([[]]);root=new (tree.Ruleset)([],$(this.parsers.primary));root.root=true;root.toCSS=(function(evaluate){var line,lines,column;return function(options,variables){var frames=[];options=options||{};if(typeof(variables)==="object"&&!Array.isArray(variables)){variables=Object.keys(variables).map(function(k){var value=variables[k];if(!(value instanceof tree.Value)){if(!(value instanceof tree.Expression)){value=new (tree.Expression)([value])}value=new (tree.Value)([value])}return new (tree.Rule)("@"+k,value,false,0)});frames=[new (tree.Ruleset)(null,variables)]}try{var css=evaluate.call(this,{frames:frames}).toCSS([],{compress:options.compress||false})}catch(e){lines=input.split("\n");line=getLine(e.index);for(var n=e.index,column=-1;n>=0&&input.charAt(n)!=="\n";n--){column++}throw {type:e.type,message:e.message,filename:env.filename,index:e.index,line:typeof(line)==="number"?line+1:null,callLine:e.call&&(getLine(e.call)+1),callExtract:lines[getLine(e.call)],stack:e.stack,column:column,extract:[lines[line-1],lines[line],lines[line+1]]}}if(options.compress){return css.replace(/(\s)+/g,"$1")}else{return css}function getLine(index){return index?(input.slice(0,index).match(/\n/g)||"").length:null}}})(root.eval);if(i<input.length-1){i=furthest;lines=input.split("\n");line=(input.slice(0,i).match(/\n/g)||"").length+1;for(var n=i,column=-1;n>=0&&input.charAt(n)!=="\n";n--){column++}error={name:"ParseError",message:"Syntax Error on line "+line,index:i,filename:env.filename,line:line,column:column,extract:[lines[line-2],lines[line-1],lines[line]]}}if(this.imports.queue.length>0){finish=function(){callback(error,root)}}else{callback(error,root)}},parsers:{primary:function(){var node,root=[];while((node=$(this.mixin.definition)||$(this.rule)||$(this.ruleset)||$(this.mixin.call)||$(this.comment)||$(this.directive))||$(/^[\s\n]+/)){node&&root.push(node)}return root},comment:function(){var comment;if(input.charAt(i)!=="/"){return}if(input.charAt(i+1)==="/"){return new (tree.Comment)($(/^\/\/.*/),true)}else{if(comment=$(/^\/\*(?:[^*]|\*+[^\/*])*\*+\/\n?/)){return new (tree.Comment)(comment)}}},entities:{quoted:function(){var str,j=i,e;if(input.charAt(j)==="~"){j++,e=true}if(input.charAt(j)!=='"'&&input.charAt(j)!=="'"){return}e&&$("~");if(str=$(/^"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'/)){return new (tree.Quoted)(str[0],str[1]||str[2],e)}},keyword:function(){var k;if(k=$(/^[_A-Za-z-][_A-Za-z0-9-]*/)){return new (tree.Keyword)(k)}},call:function(){var name,args,index=i;if(!(name=/^([\w-]+|%)\(/.exec(chunks[j]))){return}name=name[1].toLowerCase();if(name==="url"){return null}else{i+=name.length}if(name==="alpha"){return $(this.alpha)}$("(");args=$(this.entities.arguments);if(!$(")")){return}if(name){return new (tree.Call)(name,args,index)}},arguments:function(){var args=[],arg;while(arg=$(this.expression)){args.push(arg);if(!$(",")){break}}return args},literal:function(){return $(this.entities.dimension)||$(this.entities.color)||$(this.entities.quoted)},url:function(){var value;if(input.charAt(i)!=="u"||!$(/^url\(/)){return}value=$(this.entities.quoted)||$(this.entities.variable)||$(this.entities.dataURI)||$(/^[-\w%@$\/.&=:;#+?~]+/)||"";if(!$(")")){throw new (Error)("missing closing ) for url()")}return new (tree.URL)((value.value||value.data||value instanceof tree.Variable)?value:new (tree.Anonymous)(value),imports.paths)},dataURI:function(){var obj;if($(/^data:/)){obj={};obj.mime=$(/^[^\/]+\/[^,;)]+/)||"";obj.charset=$(/^;\s*charset=[^,;)]+/)||"";obj.base64=$(/^;\s*base64/)||"";obj.data=$(/^,\s*[^)]+/);if(obj.data){return obj}}},variable:function(){var name,index=i;if(input.charAt(i)==="@"&&(name=$(/^@@?[\w-]+/))){return new (tree.Variable)(name,index)}},color:function(){var rgb;if(input.charAt(i)==="#"&&(rgb=$(/^#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})/))){return new (tree.Color)(rgb[1])}},dimension:function(){var value,c=input.charCodeAt(i);if((c>57||c<45)||c===47){return}if(value=$(/^(-?\d*\.?\d+)(px|%|em|pc|ex|in|deg|s|ms|pt|cm|mm|rad|grad|turn)?/)){return new (tree.Dimension)(value[1],value[2])}},javascript:function(){var str,j=i,e;if(input.charAt(j)==="~"){j++,e=true}if(input.charAt(j)!=="`"){return}e&&$("~");if(str=$(/^`([^`]*)`/)){return new (tree.JavaScript)(str[1],i,e)}}},variable:function(){var name;if(input.charAt(i)==="@"&&(name=$(/^(@[\w-]+)\s*:/))){return name[1]}},shorthand:function(){var a,b;if(!peek(/^[@\w.%-]+\/[@\w.-]+/)){return}if((a=$(this.entity))&&$("/")&&(b=$(this.entity))){return new (tree.Shorthand)(a,b)}},mixin:{call:function(){var elements=[],e,c,args,index=i,s=input.charAt(i);if(s!=="."&&s!=="#"){return}while(e=$(/^[#.](?:[\w-]|\\(?:[a-fA-F0-9]{1,6} ?|[^a-fA-F0-9]))+/)){elements.push(new (tree.Element)(c,e,i));c=$(">")}$("(")&&(args=$(this.entities.arguments))&&$(")");if(elements.length>0&&($(";")||peek("}"))){return new (tree.mixin.Call)(elements,args,index)}},definition:function(){var name,params=[],match,ruleset,param,value;if((input.charAt(i)!=="."&&input.charAt(i)!=="#")||peek(/^[^{]*(;|})/)){return}if(match=$(/^([#.](?:[\w-]|\\(?:[a-fA-F0-9]{1,6} ?|[^a-fA-F0-9]))+)\s*\(/)){name=match[1];while(param=$(this.entities.variable)||$(this.entities.literal)||$(this.entities.keyword)){if(param instanceof tree.Variable){if($(":")){if(value=$(this.expression)){params.push({name:param.name,value:value})}else{throw new (Error)("Expected value")}}else{params.push({name:param.name})}}else{params.push({value:param})}if(!$(",")){break}}if(!$(")")){throw new (Error)("Expected )")}ruleset=$(this.block);if(ruleset){return new (tree.mixin.Definition)(name,params,ruleset)}}}},entity:function(){return $(this.entities.literal)||$(this.entities.variable)||$(this.entities.url)||$(this.entities.call)||$(this.entities.keyword)||$(this.entities.javascript)||$(this.comment)},end:function(){return $(";")||peek("}")},alpha:function(){var value;if(!$(/^\(opacity=/i)){return}if(value=$(/^\d+/)||$(this.entities.variable)){if(!$(")")){throw new (Error)("missing closing ) for alpha()")}return new (tree.Alpha)(value)}},element:function(){var e,t,c;c=$(this.combinator);e=$(/^(?:\d+\.\d+|\d+)%/)||$(/^(?:[.#]?|:*)(?:[\w-]|\\(?:[a-fA-F0-9]{1,6} ?|[^a-fA-F0-9]))+/)||$("*")||$(this.attribute)||$(/^\([^)@]+\)/);if(e){return new (tree.Element)(c,e,i)}if(c.value&&c.value.charAt(0)==="&"){return new (tree.Element)(c,null,i)}},combinator:function(){var match,c=input.charAt(i);if(c===">"||c==="+"||c==="~"){i++;while(input.charAt(i)===" "){i++}return new (tree.Combinator)(c)}else{if(c==="&"){match="&";i++;if(input.charAt(i)===" "){match="& "}while(input.charAt(i)===" "){i++}return new (tree.Combinator)(match)}else{if(c===":"&&input.charAt(i+1)===":"){i+=2;while(input.charAt(i)===" "){i++}return new (tree.Combinator)("::")}else{if(input.charAt(i-1)===" "){return new (tree.Combinator)(" ")}else{return new (tree.Combinator)(null)}}}}},selector:function(){var sel,e,elements=[],c,match;while(e=$(this.element)){c=input.charAt(i);elements.push(e);if(c==="{"||c==="}"||c===";"||c===","){break}}if(elements.length>0){return new (tree.Selector)(elements)}},tag:function(){return $(/^[a-zA-Z][a-zA-Z-]*[0-9]?/)||$("*")},attribute:function(){var attr="",key,val,op;if(!$("[")){return}if(key=$(/^[a-zA-Z-]+/)||$(this.entities.quoted)){if((op=$(/^[|~*$^]?=/))&&(val=$(this.entities.quoted)||$(/^[\w-]+/))){attr=[key,op,val.toCSS?val.toCSS():val].join("")}else{attr=key}}if(!$("]")){return}if(attr){return"["+attr+"]"}},block:function(){var content;if($("{")&&(content=$(this.primary))&&$("}")){return content}},ruleset:function(){var selectors=[],s,rules,match;save();while(s=$(this.selector)){selectors.push(s);$(this.comment);if(!$(",")){break}$(this.comment)}if(selectors.length>0&&(rules=$(this.block))){return new (tree.Ruleset)(selectors,rules)}else{furthest=i;restore()}},rule:function(){var name,value,c=input.charAt(i),important,match;save();if(c==="."||c==="#"||c==="&"){return}if(name=$(this.variable)||$(this.property)){if((name.charAt(0)!="@")&&(match=/^([^@+\/'"*`(;{}-]*);/.exec(chunks[j]))){i+=match[0].length-1;value=new (tree.Anonymous)(match[1])}else{if(name==="font"){value=$(this.font)}else{value=$(this.value)}}important=$(this.important);if(value&&$(this.end)){return new (tree.Rule)(name,value,important,memo)}else{furthest=i;restore()}}},"import":function(){var path;if($(/^@import\s+/)&&(path=$(this.entities.quoted)||$(this.entities.url))&&$(";")){return new (tree.Import)(path,imports)}},directive:function(){var name,value,rules,types;if(input.charAt(i)!=="@"){return}if(value=$(this["import"])){return value}else{if(name=$(/^@media|@page/)||$(/^@(?:-webkit-|-moz-)?keyframes/)){types=($(/^[^{]+/)||"").trim();if(rules=$(this.block)){return new (tree.Directive)(name+" "+types,rules)}}else{if(name=$(/^@[-a-z]+/)){if(name==="@font-face"){if(rules=$(this.block)){return new (tree.Directive)(name,rules)}}else{if((value=$(this.entity))&&$(";")){return new (tree.Directive)(name,value)}}}}}},font:function(){var value=[],expression=[],weight,shorthand,font,e;while(e=$(this.shorthand)||$(this.entity)){expression.push(e)}value.push(new (tree.Expression)(expression));if($(",")){while(e=$(this.expression)){value.push(e);if(!$(",")){break}}}return new (tree.Value)(value)},value:function(){var e,expressions=[],important;while(e=$(this.expression)){expressions.push(e);if(!$(",")){break}}if(expressions.length>0){return new (tree.Value)(expressions)}},important:function(){if(input.charAt(i)==="!"){return $(/^! *important/)}},sub:function(){var e;if($("(")&&(e=$(this.expression))&&$(")")){return e}},multiplication:function(){var m,a,op,operation;if(m=$(this.operand)){while((op=($("/")||$("*")))&&(a=$(this.operand))){operation=new (tree.Operation)(op,[operation||m,a])}return operation||m}},addition:function(){var m,a,op,operation;if(m=$(this.multiplication)){while((op=$(/^[-+]\s+/)||(input.charAt(i-1)!=" "&&($("+")||$("-"))))&&(a=$(this.multiplication))){operation=new (tree.Operation)(op,[operation||m,a])}return operation||m}},operand:function(){var negate,p=input.charAt(i+1);if(input.charAt(i)==="-"&&(p==="@"||p==="(")){negate=$("-")}var o=$(this.sub)||$(this.entities.dimension)||$(this.entities.color)||$(this.entities.variable)||$(this.entities.call);return negate?new (tree.Operation)("*",[new (tree.Dimension)(-1),o]):o},expression:function(){var e,delim,entities=[],d;while(e=$(this.addition)||$(this.entity)){entities.push(e)}if(entities.length>0){return new (tree.Expression)(entities)}},property:function(){var name;if(name=$(/^(\*?-?[-a-z_0-9]+)\s*:/)){return name[1]}}}}};if(less.mode==="browser"||less.mode==="rhino"){less.Parser.importer=function(path,paths,callback,env){if(path.charAt(0)!=="/"&&paths.length>0){path=paths[0]+path}loadStyleSheet({href:path,title:path,type:env.mime},callback,true)}}(function(tree){tree.functions={rgb:function(r,g,b){return this.rgba(r,g,b,1)},rgba:function(r,g,b,a){var rgb=[r,g,b].map(function(c){return number(c)}),a=number(a);return new (tree.Color)(rgb,a)},hsl:function(h,s,l){return this.hsla(h,s,l,1)},hsla:function(h,s,l,a){h=(number(h)%360)/360;s=number(s);l=number(l);a=number(a);var m2=l<=0.5?l*(s+1):l+s-l*s;var m1=l*2-m2;return this.rgba(hue(h+1/3)*255,hue(h)*255,hue(h-1/3)*255,a);function hue(h){h=h<0?h+1:(h>1?h-1:h);if(h*6<1){return m1+(m2-m1)*h*6}else{if(h*2<1){return m2}else{if(h*3<2){return m1+(m2-m1)*(2/3-h)*6}else{return m1}}}}},hue:function(color){return new (tree.Dimension)(Math.round(color.toHSL().h))},saturation:function(color){return new (tree.Dimension)(Math.round(color.toHSL().s*100),"%")},lightness:function(color){return new (tree.Dimension)(Math.round(color.toHSL().l*100),"%")},alpha:function(color){return new (tree.Dimension)(color.toHSL().a)},saturate:function(color,amount){var hsl=color.toHSL();hsl.s+=amount.value/100;hsl.s=clamp(hsl.s);return hsla(hsl)},desaturate:function(color,amount){var hsl=color.toHSL();hsl.s-=amount.value/100;hsl.s=clamp(hsl.s);return hsla(hsl)},lighten:function(color,amount){var hsl=color.toHSL();hsl.l+=amount.value/100;hsl.l=clamp(hsl.l);return hsla(hsl)},darken:function(color,amount){var hsl=color.toHSL();hsl.l-=amount.value/100;hsl.l=clamp(hsl.l);return hsla(hsl)},fadein:function(color,amount){var hsl=color.toHSL();hsl.a+=amount.value/100;hsl.a=clamp(hsl.a);return hsla(hsl)},fadeout:function(color,amount){var hsl=color.toHSL();hsl.a-=amount.value/100;hsl.a=clamp(hsl.a);return hsla(hsl)},fade:function(color,amount){var hsl=color.toHSL();hsl.a=amount.value/100;hsl.a=clamp(hsl.a);return hsla(hsl)},spin:function(color,amount){var hsl=color.toHSL();var hue=(hsl.h+amount.value)%360;hsl.h=hue<0?360+hue:hue;return hsla(hsl)},mix:function(color1,color2,weight){var p=weight.value/100;var w=p*2-1;var a=color1.toHSL().a-color2.toHSL().a;var w1=(((w*a==-1)?w:(w+a)/(1+w*a))+1)/2;var w2=1-w1;var rgb=[color1.rgb[0]*w1+color2.rgb[0]*w2,color1.rgb[1]*w1+color2.rgb[1]*w2,color1.rgb[2]*w1+color2.rgb[2]*w2];var alpha=color1.alpha*p+color2.alpha*(1-p);return new (tree.Color)(rgb,alpha)},greyscale:function(color){return this.desaturate(color,new (tree.Dimension)(100))},e:function(str){return new (tree.Anonymous)(str instanceof tree.JavaScript?str.evaluated:str)},escape:function(str){return new (tree.Anonymous)(encodeURI(str.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},"%":function(quoted){var args=Array.prototype.slice.call(arguments,1),str=quoted.value;for(var i=0;i<args.length;i++){str=str.replace(/%[sda]/i,function(token){var value=token.match(/s/i)?args[i].value:args[i].toCSS();return token.match(/[A-Z]$/)?encodeURIComponent(value):value})}str=str.replace(/%%/g,"%");return new (tree.Quoted)('"'+str+'"',str)},round:function(n){if(n instanceof tree.Dimension){return new (tree.Dimension)(Math.round(number(n)),n.unit)}else{if(typeof(n)==="number"){return Math.round(n)}else{throw {error:"RuntimeError",message:"math functions take numbers as parameters"}}}},argb:function(color){return new (tree.Anonymous)(color.toARGB())}};function hsla(hsla){return tree.functions.hsla(hsla.h,hsla.s,hsla.l,hsla.a)}function number(n){if(n instanceof tree.Dimension){return parseFloat(n.unit=="%"?n.value/100:n.value)}else{if(typeof(n)==="number"){return n}else{throw {error:"RuntimeError",message:"color functions take numbers as parameters"}}}}function clamp(val){return Math.min(1,Math.max(0,val))}})(require("./tree"));(function(tree){tree.Alpha=function(val){this.value=val};tree.Alpha.prototype={toCSS:function(){return"alpha(opacity="+(this.value.toCSS?this.value.toCSS():this.value)+")"},eval:function(env){if(this.value.eval){this.value=this.value.eval(env)}return this}}})(require("../tree"));(function(tree){tree.Anonymous=function(string){this.value=string.value||string};tree.Anonymous.prototype={toCSS:function(){return this.value},eval:function(){return this}}})(require("../tree"));(function(tree){tree.Call=function(name,args,index){this.name=name;this.args=args;this.index=index};tree.Call.prototype={eval:function(env){var args=this.args.map(function(a){return a.eval(env)});if(this.name in tree.functions){try{return tree.functions[this.name].apply(tree.functions,args)}catch(e){throw {message:"error evaluating function `"+this.name+"`",index:this.index}}}else{return new (tree.Anonymous)(this.name+"("+args.map(function(a){return a.toCSS()}).join(", ")+")")}},toCSS:function(env){return this.eval(env).toCSS()}}})(require("../tree"));(function(tree){tree.Color=function(rgb,a){if(Array.isArray(rgb)){this.rgb=rgb}else{if(rgb.length==6){this.rgb=rgb.match(/.{2}/g).map(function(c){return parseInt(c,16)})}else{this.rgb=rgb.split("").map(function(c){return parseInt(c+c,16)})}}this.alpha=typeof(a)==="number"?a:1};tree.Color.prototype={eval:function(){return this},toCSS:function(){if(this.alpha<1){return"rgba("+this.rgb.map(function(c){return Math.round(c)}).concat(this.alpha).join(", ")+")"}else{return"#"+this.rgb.map(function(i){i=Math.round(i);i=(i>255?255:(i<0?0:i)).toString(16);return i.length===1?"0"+i:i}).join("")}},operate:function(op,other){var result=[];if(!(other instanceof tree.Color)){other=other.toColor()}for(var c=0;c<3;c++){result[c]=tree.operate(op,this.rgb[c],other.rgb[c])}return new (tree.Color)(result,this.alpha+other.alpha)},toHSL:function(){var r=this.rgb[0]/255,g=this.rgb[1]/255,b=this.rgb[2]/255,a=this.alpha;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,l=(max+min)/2,d=max-min;if(max===min){h=s=0}else{s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}return{h:h*360,s:s,l:l,a:a}},toARGB:function(){var argb=[Math.round(this.alpha*255)].concat(this.rgb);return"#"+argb.map(function(i){i=Math.round(i);i=(i>255?255:(i<0?0:i)).toString(16);return i.length===1?"0"+i:i}).join("")}}})(require("../tree"));(function(tree){tree.Comment=function(value,silent){this.value=value;this.silent=!!silent};tree.Comment.prototype={toCSS:function(env){return env.compress?"":this.value},eval:function(){return this}}})(require("../tree"));(function(tree){tree.Dimension=function(value,unit){this.value=parseFloat(value);this.unit=unit||null};tree.Dimension.prototype={eval:function(){return this},toColor:function(){return new (tree.Color)([this.value,this.value,this.value])},toCSS:function(){var css=this.value+this.unit;return css},operate:function(op,other){return new (tree.Dimension)(tree.operate(op,this.value,other.value),this.unit||other.unit)}}})(require("../tree"));(function(tree){tree.Directive=function(name,value){this.name=name;if(Array.isArray(value)){this.ruleset=new (tree.Ruleset)([],value)}else{this.value=value}};tree.Directive.prototype={toCSS:function(ctx,env){if(this.ruleset){this.ruleset.root=true;return this.name+(env.compress?"{":" {\n  ")+this.ruleset.toCSS(ctx,env).trim().replace(/\n/g,"\n  ")+(env.compress?"}":"\n}\n")}else{return this.name+" "+this.value.toCSS()+";\n"}},eval:function(env){env.frames.unshift(this);this.ruleset=this.ruleset&&this.ruleset.eval(env);env.frames.shift();return this},variable:function(name){return tree.Ruleset.prototype.variable.call(this.ruleset,name)},find:function(){return tree.Ruleset.prototype.find.apply(this.ruleset,arguments)},rulesets:function(){return tree.Ruleset.prototype.rulesets.apply(this.ruleset)}}})(require("../tree"));(function(tree){tree.Element=function(combinator,value,index){this.combinator=combinator instanceof tree.Combinator?combinator:new (tree.Combinator)(combinator);this.value=value?value.trim():"";this.index=index};tree.Element.prototype.toCSS=function(env){return this.combinator.toCSS(env||{})+this.value};tree.Combinator=function(value){if(value===" "){this.value=" "}else{if(value==="& "){this.value="& "}else{this.value=value?value.trim():""}}};tree.Combinator.prototype.toCSS=function(env){return{"":""," ":" ","&":"","& ":" ",":":" :","::":"::","+":env.compress?"+":" + ","~":env.compress?"~":" ~ ",">":env.compress?">":" > "}[this.value]}})(require("../tree"));(function(tree){tree.Expression=function(value){this.value=value};tree.Expression.prototype={eval:function(env){if(this.value.length>1){return new (tree.Expression)(this.value.map(function(e){return e.eval(env)}))}else{if(this.value.length===1){return this.value[0].eval(env)}else{return this}}},toCSS:function(env){return this.value.map(function(e){return e.toCSS(env)}).join(" ")}}})(require("../tree"));(function(tree){tree.Import=function(path,imports){var that=this;this._path=path;if(path instanceof tree.Quoted){this.path=/\.(le?|c)ss(\?.*)?$/.test(path.value)?path.value:path.value+".less"}else{this.path=path.value.value||path.value}this.css=/css(\?.*)?$/.test(this.path);if(!this.css){imports.push(this.path,function(root){if(!root){throw new (Error)("Error parsing "+that.path)}that.root=root})}};tree.Import.prototype={toCSS:function(){if(this.css){return"@import "+this._path.toCSS()+";\n"}else{return""}},eval:function(env){var ruleset;if(this.css){return this}else{ruleset=new (tree.Ruleset)(null,this.root.rules.slice(0));for(var i=0;i<ruleset.rules.length;i++){if(ruleset.rules[i] instanceof tree.Import){Array.prototype.splice.apply(ruleset.rules,[i,1].concat(ruleset.rules[i].eval(env)))}}return ruleset.rules}}}})(require("../tree"));(function(tree){tree.JavaScript=function(string,index,escaped){this.escaped=escaped;this.expression=string;this.index=index};tree.JavaScript.prototype={eval:function(env){var result,that=this,context={};var expression=this.expression.replace(/@\{([\w-]+)\}/g,function(_,name){return tree.jsify(new (tree.Variable)("@"+name,that.index).eval(env))});try{expression=new (Function)("return ("+expression+")")}catch(e){throw {message:"JavaScript evaluation error: `"+expression+"`",index:this.index}}for(var k in env.frames[0].variables()){context[k.slice(1)]={value:env.frames[0].variables()[k].value,toJS:function(){return this.value.eval(env).toCSS()}}}try{result=expression.call(context)}catch(e){throw {message:"JavaScript evaluation error: '"+e.name+": "+e.message+"'",index:this.index}}if(typeof(result)==="string"){var match;if(match=/^#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.exec(result)){return new (tree.Color)(match[1])}return new (tree.Quoted)('"'+result+'"',result,this.escaped,this.index)}else{if(Array.isArray(result)){return new (tree.Anonymous)(result.join(", "))}else{return new (tree.Anonymous)(result)}}}}})(require("../tree"));(function(tree){tree.Keyword=function(value){this.value=value};tree.Keyword.prototype={eval:function(){return this},toCSS:function(){return this.value}}})(require("../tree"));(function(tree){tree.mixin={};tree.mixin.Call=function(elements,args,index){this.selector=new (tree.Selector)(elements);this.arguments=args;this.index=index};tree.mixin.Call.prototype={eval:function(env){var mixins,args,rules=[],match=false;for(var i=0;i<env.frames.length;i++){if((mixins=env.frames[i].find(this.selector)).length>0){args=this.arguments&&this.arguments.map(function(a){return a.eval(env)});for(var m=0;m<mixins.length;m++){if(mixins[m].match(args,env)){try{Array.prototype.push.apply(rules,mixins[m].eval(env,this.arguments).rules);match=true}catch(e){throw {message:e.message,index:e.index,stack:e.stack,call:this.index}}}}if(match){return rules}else{throw {message:"No matching definition was found for `"+this.selector.toCSS().trim()+"("+this.arguments.map(function(a){return a.toCSS()}).join(", ")+")`",index:this.index}}}}throw {message:this.selector.toCSS().trim()+" is undefined",index:this.index}}};tree.mixin.Definition=function(name,params,rules){this.name=name;this.selectors=[new (tree.Selector)([new (tree.Element)(null,name)])];this.params=params;this.arity=params.length;this.rules=rules;this._lookups={};this.required=params.reduce(function(count,p){if(!p.name||(p.name&&!p.value)){return count+1}else{return count}},0);this.parent=tree.Ruleset.prototype;this.frames=[]};tree.mixin.Definition.prototype={toCSS:function(){return""},variable:function(name){return this.parent.variable.call(this,name)},variables:function(){return this.parent.variables.call(this)},find:function(){return this.parent.find.apply(this,arguments)},rulesets:function(){return this.parent.rulesets.apply(this)},eval:function(env,args){var frame=new (tree.Ruleset)(null,[]),context,_arguments=[];for(var i=0,val;i<this.params.length;i++){if(this.params[i].name){if(val=(args&&args[i])||this.params[i].value){frame.rules.unshift(new (tree.Rule)(this.params[i].name,val.eval(env)))}else{throw {message:"wrong number of arguments for "+this.name+" ("+args.length+" for "+this.arity+")"}}}}for(var i=0;i<Math.max(this.params.length,args&&args.length);i++){_arguments.push(args[i]||this.params[i].value)}frame.rules.unshift(new (tree.Rule)("@arguments",new (tree.Expression)(_arguments).eval(env)));return new (tree.Ruleset)(null,this.rules.slice(0)).eval({frames:[this,frame].concat(this.frames,env.frames)})},match:function(args,env){var argsLength=(args&&args.length)||0,len;if(argsLength<this.required){return false}if((this.required>0)&&(argsLength>this.params.length)){return false}len=Math.min(argsLength,this.arity);for(var i=0;i<len;i++){if(!this.params[i].name){if(args[i].eval(env).toCSS()!=this.params[i].value.eval(env).toCSS()){return false}}}return true}}})(require("../tree"));(function(tree){tree.Operation=function(op,operands){this.op=op.trim();this.operands=operands};tree.Operation.prototype.eval=function(env){var a=this.operands[0].eval(env),b=this.operands[1].eval(env),temp;if(a instanceof tree.Dimension&&b instanceof tree.Color){if(this.op==="*"||this.op==="+"){temp=b,b=a,a=temp}else{throw {name:"OperationError",message:"Can't substract or divide a color from a number"}}}return a.operate(this.op,b)};tree.operate=function(op,a,b){switch(op){case"+":return a+b;case"-":return a-b;case"*":return a*b;case"/":return a/b}}})(require("../tree"));(function(tree){tree.Quoted=function(str,content,escaped,i){this.escaped=escaped;this.value=content||"";this.quote=str.charAt(0);this.index=i};tree.Quoted.prototype={toCSS:function(){if(this.escaped){return this.value}else{return this.quote+this.value+this.quote}},eval:function(env){var that=this;var value=this.value.replace(/`([^`]+)`/g,function(_,exp){return new (tree.JavaScript)(exp,that.index,true).eval(env).value}).replace(/@\{([\w-]+)\}/g,function(_,name){var v=new (tree.Variable)("@"+name,that.index).eval(env);return v.value||v.toCSS()});return new (tree.Quoted)(this.quote+value+this.quote,value,this.escaped,this.index)}}})(require("../tree"));(function(tree){tree.Rule=function(name,value,important,index){this.name=name;this.value=(value instanceof tree.Value)?value:new (tree.Value)([value]);this.important=important?" "+important.trim():"";this.index=index;if(name.charAt(0)==="@"){this.variable=true}else{this.variable=false}};tree.Rule.prototype.toCSS=function(env){if(this.variable){return""}else{return this.name+(env.compress?":":": ")+this.value.toCSS(env)+this.important+";"}};tree.Rule.prototype.eval=function(context){return new (tree.Rule)(this.name,this.value.eval(context),this.important,this.index)};tree.Shorthand=function(a,b){this.a=a;this.b=b};tree.Shorthand.prototype={toCSS:function(env){return this.a.toCSS(env)+"/"+this.b.toCSS(env)},eval:function(){return this}}})(require("../tree"));(function(tree){tree.Ruleset=function(selectors,rules){this.selectors=selectors;this.rules=rules;this._lookups={}};tree.Ruleset.prototype={eval:function(env){var ruleset=new (tree.Ruleset)(this.selectors,this.rules.slice(0));ruleset.root=this.root;env.frames.unshift(ruleset);if(ruleset.root){for(var i=0;i<ruleset.rules.length;i++){if(ruleset.rules[i] instanceof tree.Import){Array.prototype.splice.apply(ruleset.rules,[i,1].concat(ruleset.rules[i].eval(env)))}}}for(var i=0;i<ruleset.rules.length;i++){if(ruleset.rules[i] instanceof tree.mixin.Definition){ruleset.rules[i].frames=env.frames.slice(0)}}for(var i=0;i<ruleset.rules.length;i++){if(ruleset.rules[i] instanceof tree.mixin.Call){Array.prototype.splice.apply(ruleset.rules,[i,1].concat(ruleset.rules[i].eval(env)))}}for(var i=0,rule;i<ruleset.rules.length;i++){rule=ruleset.rules[i];if(!(rule instanceof tree.mixin.Definition)){ruleset.rules[i]=rule.eval?rule.eval(env):rule}}env.frames.shift();return ruleset},match:function(args){return !args||args.length===0},variables:function(){if(this._variables){return this._variables}else{return this._variables=this.rules.reduce(function(hash,r){if(r instanceof tree.Rule&&r.variable===true){hash[r.name]=r}return hash},{})}},variable:function(name){return this.variables()[name]},rulesets:function(){if(this._rulesets){return this._rulesets}else{return this._rulesets=this.rules.filter(function(r){return(r instanceof tree.Ruleset)||(r instanceof tree.mixin.Definition)})}},find:function(selector,self){self=self||this;var rules=[],rule,match,key=selector.toCSS();if(key in this._lookups){return this._lookups[key]}this.rulesets().forEach(function(rule){if(rule!==self){for(var j=0;j<rule.selectors.length;j++){if(match=selector.match(rule.selectors[j])){if(selector.elements.length>rule.selectors[j].elements.length){Array.prototype.push.apply(rules,rule.find(new (tree.Selector)(selector.elements.slice(1)),self))}else{rules.push(rule)}break}}}});return this._lookups[key]=rules},toCSS:function(context,env){var css=[],rules=[],rulesets=[],paths=[],selector,rule;if(!this.root){if(context.length===0){paths=this.selectors.map(function(s){return[s]})}else{this.joinSelectors(paths,context,this.selectors)}}for(var i=0;i<this.rules.length;i++){rule=this.rules[i];if(rule.rules||(rule instanceof tree.Directive)){rulesets.push(rule.toCSS(paths,env))}else{if(rule instanceof tree.Comment){if(!rule.silent){if(this.root){rulesets.push(rule.toCSS(env))}else{rules.push(rule.toCSS(env))}}}else{if(rule.toCSS&&!rule.variable){rules.push(rule.toCSS(env))}else{if(rule.value&&!rule.variable){rules.push(rule.value.toString())}}}}}rulesets=rulesets.join("");if(this.root){css.push(rules.join(env.compress?"":"\n"))}else{if(rules.length>0){selector=paths.map(function(p){return p.map(function(s){return s.toCSS(env)}).join("").trim()}).join(env.compress?",":(paths.length>3?",\n":", "));css.push(selector,(env.compress?"{":" {\n  ")+rules.join(env.compress?"":"\n  ")+(env.compress?"}":"\n}\n"))}}css.push(rulesets);return css.join("")+(env.compress?"\n":"")},joinSelectors:function(paths,context,selectors){for(var s=0;s<selectors.length;s++){this.joinSelector(paths,context,selectors[s])}},joinSelector:function(paths,context,selector){var before=[],after=[],beforeElements=[],afterElements=[],hasParentSelector=false,el;for(var i=0;i<selector.elements.length;i++){el=selector.elements[i];if(el.combinator.value.charAt(0)==="&"){hasParentSelector=true}if(hasParentSelector){afterElements.push(el)}else{beforeElements.push(el)}}if(!hasParentSelector){afterElements=beforeElements;beforeElements=[]}if(beforeElements.length>0){before.push(new (tree.Selector)(beforeElements))}if(afterElements.length>0){after.push(new (tree.Selector)(afterElements))}for(var c=0;c<context.length;c++){paths.push(before.concat(context[c]).concat(after))}}}})(require("../tree"));(function(tree){tree.Selector=function(elements){this.elements=elements;if(this.elements[0].combinator.value===""){this.elements[0].combinator.value=" "}};tree.Selector.prototype.match=function(other){var len=this.elements.length,olen=other.elements.length,max=Math.min(len,olen);if(len<olen){return false}else{for(var i=0;i<max;i++){if(this.elements[i].value!==other.elements[i].value){return false}}}return true};tree.Selector.prototype.toCSS=function(env){if(this._css){return this._css}return this._css=this.elements.map(function(e){if(typeof(e)==="string"){return" "+e.trim()}else{return e.toCSS(env)}}).join("")}})(require("../tree"));(function(tree){tree.URL=function(val,paths){if(val.data){this.attrs=val}else{if(!/^(?:https?:\/\/|file:\/\/|data:)?/.test(val.value)&&paths.length>0&&typeof(window)!=="undefined"){val.value=paths[0]+(val.value.charAt(0)==="/"?val.value.slice(1):val.value)}this.value=val;this.paths=paths}};tree.URL.prototype={toCSS:function(){return"url("+(this.attrs?"data:"+this.attrs.mime+this.attrs.charset+this.attrs.base64+this.attrs.data:this.value.toCSS())+")"},eval:function(ctx){return this.attrs?this:new (tree.URL)(this.value.eval(ctx),this.paths)}}})(require("../tree"));(function(tree){tree.Value=function(value){this.value=value;this.is="value"};tree.Value.prototype={eval:function(env){if(this.value.length===1){return this.value[0].eval(env)}else{return new (tree.Value)(this.value.map(function(v){return v.eval(env)}))}},toCSS:function(env){return this.value.map(function(e){return e.toCSS(env)}).join(env.compress?",":", ")}}})(require("../tree"));(function(tree){tree.Variable=function(name,index){this.name=name,this.index=index};tree.Variable.prototype={eval:function(env){var variable,v,name=this.name;if(name.indexOf("@@")==0){name="@"+new (tree.Variable)(name.slice(1)).eval(env).value}if(variable=tree.find(env.frames,function(frame){if(v=frame.variable(name)){return v.value.eval(env)}})){return variable}else{throw {message:"variable "+name+" is undefined",index:this.index}}}}})(require("../tree"));require("./tree").find=function(obj,fun){for(var i=0,r;i<obj.length;i++){if(r=fun.call(obj,obj[i])){return r}}return null};require("./tree").jsify=function(obj){if(Array.isArray(obj.value)&&(obj.value.length>1)){return"["+obj.value.map(function(v){return v.toCSS(false)}).join(", ")+"]"}else{return obj.toCSS(false)}};var isFileProtocol=(location.protocol==="file:"||location.protocol==="chrome:"||location.protocol==="chrome-extension:"||location.protocol==="resource:");less.env=less.env||(location.hostname=="127.0.0.1"||location.hostname=="0.0.0.0"||location.hostname=="localhost"||true||location.port.length>0||isFileProtocol?"development":"production");less.async=false;less.poll=less.poll||(isFileProtocol?1000:1500);less.watch=function(){return this.watchMode=true};less.unwatch=function(){return this.watchMode=false};if(less.env==="development"){less.optimization=0;if(/!watch/.test(location.hash)){less.watch()}less.watchTimer=setInterval(function(){if(less.watchMode){loadStyleSheets(function(root,sheet,env){if(root){createCSS(root.toCSS(),sheet,env.lastModified)}})}},less.poll)}else{less.optimization=3}var cache;try{cache=(typeof(window.localStorage)==="undefined")?null:window.localStorage}catch(_){cache=null}var links=document.getElementsByTagName("link");var typePattern=/^text\/(x-)?less$/;less.sheets=[];for(var i=0;i<links.length;i++){if(links[i].rel==="stylesheet/less"||(links[i].rel.match(/stylesheet/)&&(links[i].type.match(typePattern)))){less.sheets.push(links[i])}}less.refresh=function(reload){var startTime,endTime;startTime=endTime=new (Date);loadStyleSheets(function(root,sheet,env){if(env.local){log("loading "+sheet.href+" from cache.")}else{log("parsed "+sheet.href+" successfully.");createCSS(root.toCSS(),sheet,env.lastModified)}log("css for "+sheet.href+" generated in "+(new (Date)-endTime)+"ms");(env.remaining===0)&&log("css generated in "+(new (Date)-startTime)+"ms");endTime=new (Date)},reload);loadStyles()};less.refreshStyles=loadStyles;less.refresh(less.env==="development");function loadStyles(){var styles=document.getElementsByTagName("style");for(var i=0;i<styles.length;i++){if(styles[i].type.match(typePattern)){new (less.Parser)().parse(styles[i].innerHTML||"",function(e,tree){var css=tree.toCSS();var style=styles[i];try{style.innerHTML=css}catch(_){style.styleSheets.cssText=css}style.type="text/css"})}}}function loadStyleSheets(callback,reload){for(var i=0;i<less.sheets.length;i++){loadStyleSheet(less.sheets[i],callback,reload,less.sheets.length-(i+1))}}function loadStyleSheet(sheet,callback,reload,remaining){var url=window.location.href.replace(/[#?].*$/,"");var href=sheet.href.replace(/\?.*$/,"");var css=cache&&cache.getItem(href);var timestamp=cache&&cache.getItem(href+":timestamp");var styles={css:css,timestamp:timestamp};if(!/^(https?|file):/.test(href)){if(href.charAt(0)=="/"){href=window.location.protocol+"//"+window.location.host+href}else{href=url.slice(0,url.lastIndexOf("/")+1)+href}}xhr(sheet.href,sheet.type,function(data,lastModified){if(!reload&&styles&&lastModified&&(new (Date)(lastModified).valueOf()===new (Date)(styles.timestamp).valueOf())){createCSS(styles.css,sheet);callback(null,sheet,{local:true,remaining:remaining})}else{try{new (less.Parser)({optimization:less.optimization,paths:[href.replace(/[\w\.-]+$/,"")],mime:sheet.type}).parse(data,function(e,root){if(e){return error(e,href)}try{callback(root,sheet,{local:false,lastModified:lastModified,remaining:remaining});removeNode(document.getElementById("less-error-message:"+extractId(href)))}catch(e){error(e,href)}})}catch(e){error(e,href)}}},function(status,url){throw new (Error)("Couldn't load "+url+" ("+status+")")})}function extractId(href){return href.replace(/^[a-z]+:\/\/?[^\/]+/,"").replace(/^\//,"").replace(/\?.*$/,"").replace(/\.[^\.\/]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")}function createCSS(styles,sheet,lastModified){var css;var href=sheet.href?sheet.href.replace(/\?.*$/,""):"";var id="less:"+(sheet.title||extractId(href));if((css=document.getElementById(id))===null){css=document.createElement("style");css.type="text/css";css.media=sheet.media||"screen";css.id=id;document.getElementsByTagName("head")[0].appendChild(css)}if(css.styleSheet){try{css.styleSheet.cssText=styles}catch(e){throw new (Error)("Couldn't reassign styleSheet.cssText.")}}else{(function(node){if(css.childNodes.length>0){if(css.firstChild.nodeValue!==node.nodeValue){css.replaceChild(node,css.firstChild)}}else{css.appendChild(node)}})(document.createTextNode(styles))}if(lastModified&&cache){log("saving "+href+" to cache.");cache.setItem(href,styles);cache.setItem(href+":timestamp",lastModified)}}function xhr(url,type,callback,errback){var xhr=getXMLHttpRequest();var async=isFileProtocol?false:less.async;if(typeof(xhr.overrideMimeType)==="function"){xhr.overrideMimeType("text/css")}xhr.open("GET",url,async);xhr.setRequestHeader("Accept",type||"text/x-less, text/css; q=0.9, */*; q=0.5");xhr.send(null);if(isFileProtocol){if(xhr.status===0){callback(xhr.responseText)}else{errback(xhr.status,url)}}else{if(async){xhr.onreadystatechange=function(){if(xhr.readyState==4){handleResponse(xhr,callback,errback)}}}else{handleResponse(xhr,callback,errback)}}function handleResponse(xhr,callback,errback){if(xhr.status>=200&&xhr.status<300){callback(xhr.responseText,xhr.getResponseHeader("Last-Modified"))}else{if(typeof(errback)==="function"){errback(xhr.status,url)}}}}function getXMLHttpRequest(){if(window.XMLHttpRequest){return new (XMLHttpRequest)}else{try{return new (ActiveXObject)("MSXML2.XMLHTTP.3.0")}catch(e){log("browser doesn't support AJAX.");return null}}}function removeNode(node){return node&&node.parentNode.removeChild(node)}function log(str){if(less.env=="development"&&typeof(console)!=="undefined"){console.log("less: "+str)}}function error(e,href){var id="less-error-message:"+extractId(href);var template=["<ul>",'<li><label>[-1]</label><pre class="ctx">{0}</pre></li>',"<li><label>[0]</label><pre>{current}</pre></li>",'<li><label>[1]</label><pre class="ctx">{2}</pre></li>',"</ul>"].join("\n");var elem=document.createElement("div"),timer,content;elem.id=id;elem.className="less-error-message";content="<h3>"+(e.message||"There is an error in your .less file")+'</h3><p><a href="'+href+'">'+href+"</a> ";if(e.extract){content+="on line "+e.line+", column "+(e.column+1)+":</p>"+template.replace(/\[(-?\d)\]/g,function(_,i){return(parseInt(e.line)+parseInt(i))||""}).replace(/\{(\d)\}/g,function(_,i){return e.extract[parseInt(i)]||""}).replace(/\{current\}/,e.extract[1].slice(0,e.column)+'<span class="error">'+e.extract[1].slice(e.column)+"</span>")}elem.innerHTML=content;createCSS([".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #ee4444;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.ctx {","color: #dd4444;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"});elem.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";");if(less.env=="development"){timer=setInterval(function(){if(document.body){if(document.getElementById(id)){document.body.replaceChild(elem,document.getElementById(id))}else{document.body.insertBefore(elem,document.body.firstChild)}clearInterval(timer)}},10)}}})(window);(function(){if(!window.addEventListener){return}var a=window.StyleFix={link:function(f){try{if(!/\bstylesheet\b/i.test(f.rel)||!f.sheet.cssRules){return}}catch(h){return}var c=f.href||f.getAttribute("data-href"),g=c.replace(/[^\/]+$/,""),d=f.parentNode,i=new XMLHttpRequest();i.open("GET",c);i.onreadystatechange=function(){if(i.readyState===4){var e=i.responseText;if(e&&f.parentNode){e=a.fix(e,true,f);if(g){e=e.replace(/url\((?:'|")?(.+?)(?:'|")?\)/gi,function(k,l){if(!/^([a-z]{3,10}:|\/)/i.test(l)){return'url("'+g+l+'")'}return k});e=e.replace(RegExp("\\b(behavior:\\s*?url\\('?\"?)"+g,"gi"),"$1")}var j=document.createElement("style");j.textContent=e;j.media=f.media;j.disabled=f.disabled;j.setAttribute("data-href",f.getAttribute("href"));d.insertBefore(j,f);d.removeChild(f)}}};i.send(null);f.setAttribute("data-inprogress","")},styleElement:function(d){var c=d.disabled;d.textContent=a.fix(d.textContent,true,d);d.disabled=c},styleAttribute:function(d){var c=d.getAttribute("style");c=a.fix(c,false,d);d.setAttribute("style",c)},process:function(){b('link[rel~="stylesheet"]:not([data-inprogress])').forEach(StyleFix.link);b("style").forEach(StyleFix.styleElement);b("[style]").forEach(StyleFix.styleAttribute)},register:function(d,c){(a.fixers=a.fixers||[]).splice(c===undefined?a.fixers.length:c,0,d)},fix:function(e,c){for(var d=0;d<a.fixers.length;d++){e=a.fixers[d](e,c)||e}return e},camelCase:function(c){return c.replace(/-([a-z])/g,function(e,d){return d.toUpperCase()}).replace("-","")},deCamelCase:function(c){return c.replace(/[A-Z]/g,function(d){return"-"+d.toLowerCase()})}};(function(){setTimeout(function(){b('link[rel~="stylesheet"]').forEach(StyleFix.link)},10);document.addEventListener("DOMContentLoaded",StyleFix.process,false)})();function b(d,c){return[].slice.call((c||document).querySelectorAll(d))}})();(function(a,d){if(!window.StyleFix||!window.getComputedStyle){return}var b=window.PrefixFree={prefixCSS:function(g,f){var i=b.prefix;function e(m,l,n,j){m=b[m];if(m.length){var k=RegExp(l+"("+m.join("|")+")"+n,"gi");g=g.replace(k,j)}}e("functions","(\\s|:)","\\s*\\(","$1"+i+"$2(");e("keywords","(\\s|:)","(\\s|;|\\}||$)","$1"+i+"$2$3");e("properties","(^|\\{|\\s|;)","\\s*:","$1"+i+"$2:");if(b.properties.length){var h=RegExp("\\b("+b.properties.join("|")+")(?!:)","gi");e("valueProperties","\\b",":(.+?);",function(j){return j.replace(h,i+"$1")})}if(f){e("selectors","","\\b",b.prefixSelector);e("atrules","@","\\b","@"+i+"$1")}g=g.replace(RegExp("-"+i,"g"),"-");return g},prefixSelector:function(e){return e.replace(/^:{1,2}/,function(f){return f+b.prefix})},prefixProperty:function(g,f){var e=b.prefix+g;return f?StyleFix.camelCase(e):e}};(function(){var h={},k={prefix:"",uses:0},m=[],l={},e=getComputedStyle(document.documentElement,null),g=document.createElement("div").style;var f=function(s){c(m,s);if(s.indexOf("-")>-1){var t=s.split("-");if(s.charAt(0)==="-"){var r=t[1],p=++h[r]||1;h[r]=p;if(k.uses<p){k={prefix:r,uses:p}}while(t.length>3){t.pop();var q=t.join("-"),i=StyleFix.camelCase(q);if(i in g){c(m,q)}}}}};if(e.length>0){for(var j=0;j<e.length;j++){f(e[j])}}else{for(var o in e){f(StyleFix.deCamelCase(o))}}b.prefix="-"+k.prefix+"-";b.Prefix=StyleFix.camelCase(b.prefix);m.sort();b.properties=[];for(var j=0;j<m.length;j++){var o=m[j];if(o.charAt(0)!=="-"){break}if(o.indexOf(b.prefix)===0){var n=o.slice(b.prefix.length);if(!(StyleFix.camelCase(n) in g)){b.properties.push(n)}}}if(b.Prefix=="Ms"&&!("transform" in g)&&!("MsTransform" in g)&&("msTransform" in g)){b.properties.push("transform","transform-origin")}b.properties.sort()})();(function(){var g={"linear-gradient":{property:"backgroundImage",params:"red, teal"},calc:{property:"width",params:"1px + 5%"},element:{property:"backgroundImage",params:"#foo"}},i={initial:"color","zoom-in":"cursor","zoom-out":"cursor",box:"display",flexbox:"display","inline-flexbox":"display"};g["repeating-linear-gradient"]=g["repeating-radial-gradient"]=g["radial-gradient"]=g["linear-gradient"];b.functions=[];b.keywords=[];var e=document.createElement("div").style;function h(o,n){e[n]="";e[n]=o;return !!e[n]}for(var f in g){var k=g[f],m=k.property,l=f+"("+k.params+")";if(!h(l,m)&&h(b.prefix+l,m)){b.functions.push(f)}}for(var j in i){var m=i[j];if(!h(j,m)&&h(b.prefix+j,m)){b.keywords.push(j)}}})();(function(){var h={":read-only":null,":read-write":null,":any-link":null,"::selection":null},g={keyframes:"name",viewport:null,document:'regexp(".")'};b.selectors=[];b.atrules=[];var i=a.appendChild(document.createElement("style"));function j(l){i.textContent=l+"{}";return !!i.sheet.cssRules.length}for(var e in h){var k=e+(h[e]?"("+h[e]+")":"");if(!j(k)&&j(b.prefixSelector(k))){b.selectors.push(e)}}for(var f in g){var k=f+" "+(g[f]||"");if(!j("@"+k)&&j("@"+b.prefix+k)){b.atrules.push(f)}}a.removeChild(i)})();b.valueProperties=["transition","transition-property"];a.className+=" "+b.prefix;StyleFix.register(b.prefixCSS);function c(e,f){if(e.indexOf(f)===-1){e.push(f)}}})(document.documentElement);
/*! Socket.IO.js build:0.9.0, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */
(function(a,b){var c=a;c.version="0.9.0";c.protocol=1;c.transports=[];c.j=[];c.sockets={};c.connect=function(h,f){var g=c.util.parseUri(h),i,d;if(b&&b.location){g.protocol=g.protocol||b.location.protocol.slice(0,-1);g.host=g.host||(b.document?b.document.domain:b.location.hostname);g.port=g.port||b.location.port}i=c.util.uniqueUri(g);var e={host:g.host,secure:"https"==g.protocol,port:g.port||("https"==g.protocol?443:80),query:g.query||""};c.util.merge(e,f);if(e["force new connection"]||!c.sockets[i]){d=new c.Socket(e)}if(!e["force new connection"]&&d){c.sockets[i]=d}d=d||c.sockets[i];return d.of(g.path.length>1?g.path:"")}})("object"===typeof module?module.exports:(this.io={}),this);(function(b,d){var a=b.util={};var c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];a.parseUri=function(l){var h=c.exec(l||""),k={},j=14;while(j--){k[e[j]]=h[j]||""}return k};a.uniqueUri=function(j){var k=j.protocol,i=j.host,h=j.port;if("document" in d){i=i||document.domain;h=h||(k=="https"&&document.location.protocol!=="https:"?443:document.location.port)}else{i=i||"localhost";if(!h&&k=="https"){h=443}}return(k||"http")+"://"+i+":"+(h||80)};a.query=function(l,h){var k=a.chunkQuery(l||""),j=[];a.merge(k,a.chunkQuery(h||""));for(var i in k){if(k.hasOwnProperty(i)){j.push(i+"="+k[i])}}return j.length?"?"+j.join("&"):""};a.chunkQuery=function(h){var n={},o=h.split("&"),k=0,j=o.length,m;for(;k<j;++k){m=o[k].split("=");if(m[0]){n[m[0]]=m[1]}}return n};var f=false;a.load=function(h){if("document" in d&&document.readyState==="complete"||f){return h()}a.on(d,"load",h,false)};a.on=function(i,k,j,h){if(i.attachEvent){i.attachEvent("on"+k,j)}else{if(i.addEventListener){i.addEventListener(k,j,h)}}};a.request=function(h){if(h&&"undefined"!=typeof XDomainRequest){return new XDomainRequest()}if("undefined"!=typeof XMLHttpRequest&&(!h||a.ua.hasCORS)){return new XMLHttpRequest()}if(!h){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(i){}}return null};if("undefined"!=typeof window){a.load(function(){f=true})}a.defer=function(h){if(!a.ua.webkit||"undefined"!=typeof importScripts){return h()}a.load(function(){setTimeout(h,100)})};a.merge=function g(l,h,i,k){var j=k||[],m=typeof i=="undefined"?2:i,n;for(n in h){if(h.hasOwnProperty(n)&&a.indexOf(j,n)<0){if(typeof l[n]!=="object"||!m){l[n]=h[n];j.push(h[n])}else{a.merge(l[n],h[n],m-1,j)}}}return l};a.mixin=function(i,h){a.merge(i.prototype,h.prototype)};a.inherit=function(i,h){function j(){}j.prototype=h.prototype;i.prototype=new j};a.isArray=Array.isArray||function(h){return Object.prototype.toString.call(h)==="[object Array]"};a.intersect=function(h,k){var m=[],o=h.length>k.length?h:k,p=h.length>k.length?k:h;for(var n=0,j=p.length;n<j;n++){if(~a.indexOf(o,p[n])){m.push(p[n])}}return m};a.indexOf=function(h,m,l){for(var k=h.length,l=l<0?l+k<0?0:l+k:l||0;l<k&&h[l]!==m;l++){}return k<=l?-1:l};a.toArray=function(m){var h=[];for(var k=0,j=m.length;k<j;k++){h.push(m[k])}return h};a.ua={};a.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&(function(){try{var h=new XMLHttpRequest()}catch(i){return false}return h.withCredentials!=undefined})();a.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)})("undefined"!=typeof io?io:module.exports,this);(function(a,c){a.EventEmitter=b;function b(){}b.prototype.on=function(d,e){if(!this.$events){this.$events={}}if(!this.$events[d]){this.$events[d]=e}else{if(c.util.isArray(this.$events[d])){this.$events[d].push(e)}else{this.$events[d]=[this.$events[d],e]}}return this};b.prototype.addListener=b.prototype.on;b.prototype.once=function(f,g){var e=this;function d(){e.removeListener(f,d);g.apply(this,arguments)}d.listener=g;this.on(f,d);return this};b.prototype.removeListener=function(e,g){if(this.$events&&this.$events[e]){var h=this.$events[e];if(c.util.isArray(h)){var j=-1;for(var f=0,d=h.length;f<d;f++){if(h[f]===g||(h[f].listener&&h[f].listener===g)){j=f;break}}if(j<0){return this}h.splice(j,1);if(!h.length){delete this.$events[e]}}else{if(h===g||(h.listener&&h.listener===g)){delete this.$events[e]}}}return this};b.prototype.removeAllListeners=function(d){if(this.$events&&this.$events[d]){this.$events[d]=null}return this};b.prototype.listeners=function(d){if(!this.$events){this.$events={}}if(!this.$events[d]){this.$events[d]=[]}if(!c.util.isArray(this.$events[d])){this.$events[d]=[this.$events[d]]}return this.$events[d]};b.prototype.emit=function(f){if(!this.$events){return false}var j=this.$events[f];if(!j){return false}var e=Array.prototype.slice.call(arguments,1);if("function"==typeof j){j.apply(this,e)}else{if(c.util.isArray(j)){var h=j.slice();for(var g=0,d=h.length;g<d;g++){h[g].apply(this,e)}}else{return false}}return true}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);(function(exports,nativeJSON){if(nativeJSON&&nativeJSON.parse){return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify}}var JSON=exports.JSON={};function f(n){return n<10?"0"+n:n}function date(d,key){return isFinite(d.valueOf())?d.getUTCFullYear()+"-"+f(d.getUTCMonth()+1)+"-"+f(d.getUTCDate())+"T"+f(d.getUTCHours())+":"+f(d.getUTCMinutes())+":"+f(d.getUTCSeconds())+"Z":null}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value instanceof Date){value=date(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})};JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}})("undefined"!=typeof io?io:module.exports,typeof JSON!=="undefined"?JSON:undefined);(function(d,g){var a=d.parser={};var e=a.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"];var b=a.reasons=["transport not supported","client not handshaken","unauthorized"];var c=a.advice=["reconnect"];var i=g.JSON,h=g.util.indexOf;a.encodePacket=function(k){var p=h(e,k.type),j=k.id||"",r=k.endpoint||"",s=k.ack,n=null;switch(k.type){case"error":var o=k.reason?h(b,k.reason):"",l=k.advice?h(c,k.advice):"";if(o!==""||l!==""){n=o+(l!==""?("+"+l):"")}break;case"message":if(k.data!==""){n=k.data}break;case"event":var q={name:k.name};if(k.args&&k.args.length){q.args=k.args}n=i.stringify(q);break;case"json":n=i.stringify(k.data);break;case"connect":if(k.qs){n=k.qs}break;case"ack":n=k.ackId+(k.args&&k.args.length?"+"+i.stringify(k.args):"");break}var m=[p,j+(s=="data"?"+":""),r];if(n!==null&&n!==undefined){m.push(n)}return m.join(":")};a.encodePayload=function(o){var k="";if(o.length==1){return o[0]}for(var m=0,j=o.length;m<j;m++){var n=o[m];k+="\ufffd"+n.length+"\ufffd"+o[m]}return k};var f=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;a.decodePacket=function(l){var k=l.match(f);if(!k){return{}}var o=k[2]||"",l=k[5]||"",n={type:e[k[1]],endpoint:k[4]||""};if(o){n.id=o;if(k[3]){n.ack="data"}else{n.ack=true}}switch(n.type){case"error":var k=l.split("+");n.reason=b[k[0]]||"";n.advice=c[k[1]]||"";break;case"message":n.data=l||"";break;case"event":try{var j=i.parse(l);n.name=j.name;n.args=j.args}catch(m){}n.args=n.args||[];break;case"json":try{n.data=i.parse(l)}catch(m){}break;case"connect":n.qs=l||"";break;case"ack":var k=l.match(/^([0-9]+)(\+)?(.*)/);if(k){n.ackId=k[1];n.args=[];if(k[3]){try{n.args=k[3]?i.parse(k[3]):[]}catch(m){}}}break;case"disconnect":case"heartbeat":break}return n};a.decodePayload=function(m){if(m.charAt(0)=="\ufffd"){var j=[];for(var k=1,l="";k<m.length;k++){if(m.charAt(k)=="\ufffd"){j.push(a.decodePacket(m.substr(k+1).substr(0,l)));k+=Number(l)+1;l=""}else{l+=m.charAt(k)}}return j}else{return[a.decodePacket(m)]}}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);(function(a,c){a.Transport=b;function b(d,e){this.socket=d;this.sessid=e}c.util.mixin(b,c.EventEmitter);b.prototype.onData=function(g){this.clearCloseTimeout();if(this.socket.connected||this.socket.connecting||this.socket.reconnecting){this.setCloseTimeout()}if(g!==""){var f=c.parser.decodePayload(g);if(f&&f.length){for(var e=0,d=f.length;e<d;e++){this.onPacket(f[e])}}}return this};b.prototype.onPacket=function(d){if(d.type=="heartbeat"){return this.onHeartbeat()}if(d.type=="connect"&&d.endpoint==""){this.onConnect()}this.socket.onPacket(d);return this};b.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var d=this;this.closeTimeout=setTimeout(function(){d.onDisconnect()},this.socket.closeTimeout)}};b.prototype.onDisconnect=function(){if(this.close&&this.open){this.close()}this.clearTimeouts();this.socket.onDisconnect();return this};b.prototype.onConnect=function(){this.socket.onConnect();return this};b.prototype.clearCloseTimeout=function(){if(this.closeTimeout){clearTimeout(this.closeTimeout);this.closeTimeout=null}};b.prototype.clearTimeouts=function(){this.clearCloseTimeout();if(this.reopenTimeout){clearTimeout(this.reopenTimeout)}};b.prototype.packet=function(d){this.send(c.parser.encodePacket(d))};b.prototype.onHeartbeat=function(d){this.packet({type:"heartbeat"})};b.prototype.onOpen=function(){this.open=true;this.clearCloseTimeout();this.socket.onOpen()};b.prototype.onClose=function(){var d=this;this.open=false;this.socket.onClose();this.onDisconnect()};b.prototype.prepareUrl=function(){var d=this.socket.options;return this.scheme()+"://"+d.host+":"+d.port+"/"+d.resource+"/"+c.protocol+"/"+this.name+"/"+this.sessid};b.prototype.ready=function(d,e){e.call(this)}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);(function(b,e,c){b.Socket=a;function a(g){this.options={port:80,secure:false,document:"document" in c?document:false,resource:"socket.io",transports:e.transports,"connect timeout":10000,"try multiple transports":true,reconnect:true,"reconnection delay":500,"reconnection limit":Infinity,"reopen delay":3000,"max reconnection attempts":10,"sync disconnect on unload":true,"auto connect":true,"flash policy port":10843};e.util.merge(this.options,g);this.connected=false;this.open=false;this.connecting=false;this.reconnecting=false;this.namespaces={};this.buffer=[];this.doBuffer=false;if(this.options["sync disconnect on unload"]&&(!this.isXDomain()||e.util.ua.hasCORS)){var f=this;e.util.on(c,"beforeunload",function(){f.disconnectSync()},false)}if(this.options["auto connect"]){this.connect()}}e.util.mixin(a,e.EventEmitter);a.prototype.of=function(f){if(!this.namespaces[f]){this.namespaces[f]=new e.SocketNamespace(this,f);if(f!==""){this.namespaces[f].packet({type:"connect"})}}return this.namespaces[f]};a.prototype.publish=function(){this.emit.apply(this,arguments);var g;for(var f in this.namespaces){if(this.namespaces.hasOwnProperty(f)){g=this.of(f);g.$emit.apply(g,arguments)}}};function d(){}a.prototype.handshake=function(l){var h=this,j=this.options;function f(n){if(n instanceof Error){h.onError(n.message)}else{l.apply(null,n.split(":"))}}var i=["http"+(j.secure?"s":"")+":/",j.host+":"+j.port,j.resource,e.protocol,e.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!e.util.ua.hasCORS){var k=document.getElementsByTagName("script")[0],g=document.createElement("script");g.src=i+"&jsonp="+e.j.length;k.parentNode.insertBefore(g,k);e.j.push(function(n){f(n);g.parentNode.removeChild(g)})}else{var m=e.util.request();m.open("GET",i,true);m.withCredentials=true;m.onreadystatechange=function(){if(m.readyState==4){m.onreadystatechange=d;if(m.status==200){f(m.responseText)}else{!h.reconnecting&&h.onError(m.responseText)}}};m.send(null)}};a.prototype.getTransport=function(j){var f=j||this.transports,g;for(var h=0,k;k=f[h];h++){if(e.Transport[k]&&e.Transport[k].check(this)&&(!this.isXDomain()||e.Transport[k].xdomainCheck())){return new e.Transport[k](this,this.sessionid)}}return null};a.prototype.connect=function(g){if(this.connecting){return this}var f=this;this.handshake(function(h,k,l,j){f.sessionid=h;f.closeTimeout=l*1000;f.heartbeatTimeout=k*1000;f.transports=e.util.intersect(j.split(","),f.options.transports);function i(m){if(f.transport){f.transport.clearTimeouts()}f.transport=f.getTransport(m);if(!f.transport){return f.publish("connect_failed")}f.transport.ready(f,function(){f.connecting=true;f.publish("connecting",f.transport.name);f.transport.open();if(f.options["connect timeout"]){f.connectTimeoutTimer=setTimeout(function(){if(!f.connected){f.connecting=false;if(f.options["try multiple transports"]){if(!f.remainingTransports){f.remainingTransports=f.transports.slice(0)}var n=f.remainingTransports;while(n.length>0&&n.splice(0,1)[0]!=f.transport.name){}if(n.length){i(n)}else{f.publish("connect_failed")}}}},f.options["connect timeout"])}})}i();f.once("connect",function(){clearTimeout(f.connectTimeoutTimer);g&&typeof g=="function"&&g()})});return this};a.prototype.packet=function(f){if(this.connected&&!this.doBuffer){this.transport.packet(f)}else{this.buffer.push(f)}return this};a.prototype.setBuffer=function(f){this.doBuffer=f;if(!f&&this.connected&&this.buffer.length){this.transport.payload(this.buffer);this.buffer=[]}};a.prototype.disconnect=function(){if(this.connected){if(this.open){this.of("").packet({type:"disconnect"})}this.onDisconnect("booted")}return this};a.prototype.disconnectSync=function(){var g=e.util.request(),f=this.resource+"/"+e.protocol+"/"+this.sessionid;g.open("GET",f,true);this.onDisconnect("booted")};a.prototype.isXDomain=function(){var f=c.location.port||("https:"==c.location.protocol?443:80);return this.options.host!==c.location.hostname||this.options.port!=f};a.prototype.onConnect=function(){if(!this.connected){this.connected=true;this.connecting=false;if(!this.doBuffer){this.setBuffer(false)}this.emit("connect")}};a.prototype.onOpen=function(){this.open=true};a.prototype.onClose=function(){this.open=false};a.prototype.onPacket=function(f){this.of(f.endpoint).onPacket(f)};a.prototype.onError=function(f){if(f&&f.advice){if(this.options.reconnect&&f.advice==="reconnect"&&this.connected){this.disconnect();this.reconnect()}}this.publish("error",f&&f.reason?f.reason:f)};a.prototype.onDisconnect=function(g){var f=this.connected;this.connected=false;this.connecting=false;this.open=false;if(f){this.transport.close();this.transport.clearTimeouts();this.publish("disconnect",g);if("booted"!=g&&this.options.reconnect&&!this.reconnecting){this.reconnect()}}};a.prototype.reconnect=function(){this.reconnecting=true;this.reconnectionAttempts=0;this.reconnectionDelay=this.options["reconnection delay"];var i=this,h=this.options["max reconnection attempts"],f=this.options["try multiple transports"],g=this.options["reconnection limit"];function j(){if(i.connected){for(var l in i.namespaces){if(i.namespaces.hasOwnProperty(l)&&""!==l){i.namespaces[l].packet({type:"connect"})}}i.publish("reconnect",i.transport.name,i.reconnectionAttempts)}clearTimeout(i.reconnectionTimer);i.removeListener("connect_failed",k);i.removeListener("connect",k);i.reconnecting=false;delete i.reconnectionAttempts;delete i.reconnectionDelay;delete i.reconnectionTimer;delete i.redoTransports;i.options["try multiple transports"]=f}function k(){if(!i.reconnecting){return}if(i.connected){return j()}if(i.connecting&&i.reconnecting){return i.reconnectionTimer=setTimeout(k,1000)}if(i.reconnectionAttempts++>=h){if(!i.redoTransports){i.on("connect_failed",k);i.options["try multiple transports"]=true;i.transport=i.getTransport();i.redoTransports=true;i.connect()}else{i.publish("reconnect_failed");j()}}else{if(i.reconnectionDelay<g){i.reconnectionDelay*=2}i.connect();i.publish("reconnecting",i.reconnectionDelay,i.reconnectionAttempts);i.reconnectionTimer=setTimeout(k,i.reconnectionDelay)}}this.options["try multiple transports"]=false;this.reconnectionTimer=setTimeout(k,this.reconnectionDelay);this.on("connect",k)}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);(function(a,d){a.SocketNamespace=b;function b(e,f){this.socket=e;this.name=f||"";this.flags={};this.json=new c(this,"json");this.ackPackets=0;this.acks={}}d.util.mixin(b,d.EventEmitter);b.prototype.$emit=d.EventEmitter.prototype.emit;b.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)};b.prototype.packet=function(e){e.endpoint=this.name;this.socket.packet(e);this.flags={};return this};b.prototype.send=function(f,e){var g={type:this.flags.json?"json":"message",data:f};if("function"==typeof e){g.id=++this.ackPackets;g.ack=true;this.acks[g.id]=e}return this.packet(g)};b.prototype.emit=function(f){var e=Array.prototype.slice.call(arguments,1),h=e[e.length-1],g={type:"event",name:f};if("function"==typeof h){g.id=++this.ackPackets;g.ack="data";this.acks[g.id]=h;e=e.slice(0,e.length-1)}g.args=e;return this.packet(g)};b.prototype.disconnect=function(){if(this.name===""){this.socket.disconnect()}else{this.packet({type:"disconnect"});this.$emit("disconnect")}return this};b.prototype.onPacket=function(f){var e=this;function h(){e.packet({type:"ack",args:d.util.toArray(arguments),ackId:f.id})}switch(f.type){case"connect":this.$emit("connect");break;case"disconnect":if(this.name===""){this.socket.onDisconnect(f.reason||"booted")}else{this.$emit("disconnect",f.reason)}break;case"message":case"json":var g=["message",f.data];if(f.ack=="data"){g.push(h)}else{if(f.ack){this.packet({type:"ack",ackId:f.id})}}this.$emit.apply(this,g);break;case"event":var g=[f.name].concat(f.args);if(f.ack=="data"){g.push(h)}this.$emit.apply(this,g);break;case"ack":if(this.acks[f.ackId]){this.acks[f.ackId].apply(this,f.args);delete this.acks[f.ackId]}break;case"error":if(f.advice){this.socket.onError(f)}else{if(f.reason=="unauthorized"){this.$emit("connect_failed",f.reason)}else{this.$emit("error",f.reason)}}break}};function c(f,e){this.namespace=f;this.name=e}c.prototype.send=function(){this.namespace.flags[this.name]=true;this.namespace.send.apply(this.namespace,arguments)};c.prototype.emit=function(){this.namespace.flags[this.name]=true;this.namespace.emit.apply(this.namespace,arguments)}})("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports);(function(b,d,c){b.websocket=a;function a(e){d.Transport.apply(this,arguments)}d.util.inherit(a,d.Transport);a.prototype.name="websocket";a.prototype.open=function(){var g=d.util.query(this.socket.options.query),f=this,e;if(!e){e=c.MozWebSocket||c.WebSocket}this.websocket=new e(this.prepareUrl()+g);this.websocket.onopen=function(){f.onOpen();f.socket.setBuffer(false)};this.websocket.onmessage=function(h){f.onData(h.data)};this.websocket.onclose=function(){f.onClose();f.socket.setBuffer(true)};this.websocket.onerror=function(h){f.onError(h)};return this};a.prototype.send=function(e){this.websocket.send(e);return this};a.prototype.payload=function(e){for(var g=0,f=e.length;g<f;g++){this.packet(e[g])}return this};a.prototype.close=function(){this.websocket.close();return this};a.prototype.onError=function(f){this.socket.onError(f)};a.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"};a.check=function(){return("WebSocket" in c&&!("__addTask" in WebSocket))||"MozWebSocket" in c};a.xdomainCheck=function(){return true};d.transports.push("websocket")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);(function(a,e,c){a.XHR=b;function b(f){if(!f){return}e.Transport.apply(this,arguments);this.sendBuffer=[]}e.util.inherit(b,e.Transport);b.prototype.open=function(){this.socket.setBuffer(false);this.onOpen();this.get();this.setCloseTimeout();return this};b.prototype.payload=function(j){var h=[];for(var g=0,f=j.length;g<f;g++){h.push(e.parser.encodePacket(j[g]))}this.send(e.parser.encodePayload(h))};b.prototype.send=function(f){this.post(f);return this};function d(){}b.prototype.post=function(h){var g=this;this.socket.setBuffer(true);function f(){if(this.readyState==4){this.onreadystatechange=d;g.posting=false;if(this.status==200){g.socket.setBuffer(false)}else{g.onClose()}}}function i(){this.onload=d;g.socket.setBuffer(false)}this.sendXHR=this.request("POST");if(c.XDomainRequest&&this.sendXHR instanceof XDomainRequest){this.sendXHR.onload=this.sendXHR.onerror=i}else{this.sendXHR.onreadystatechange=f}this.sendXHR.send(h)};b.prototype.close=function(){this.onClose();return this};b.prototype.request=function(i){var f=e.util.request(this.socket.isXDomain()),g=e.util.query(this.socket.options.query,"t="+ +new Date);f.open(i||"GET",this.prepareUrl()+g,true);if(i=="POST"){try{if(f.setRequestHeader){f.setRequestHeader("Content-type","text/plain;charset=UTF-8")}else{f.contentType="text/plain"}}catch(h){}}return f};b.prototype.scheme=function(){return this.socket.options.secure?"https":"http"};b.check=function(f,g){try{if(e.util.request(g)){return true}}catch(h){}return false};b.xdomainCheck=function(){return b.check(null,true)}})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);(function(a,c){a.htmlfile=b;function b(d){c.Transport.XHR.apply(this,arguments)}c.util.inherit(b,c.Transport.XHR);b.prototype.name="htmlfile";b.prototype.get=function(){this.doc=new ActiveXObject("htmlfile");this.doc.open();this.doc.write("<html></html>");this.doc.close();this.doc.parentWindow.s=this;var d=this.doc.createElement("div");d.className="socketio";this.doc.body.appendChild(d);this.iframe=this.doc.createElement("iframe");d.appendChild(this.iframe);var e=this,f=c.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+f;c.util.on(window,"unload",function(){e.destroy()})};b.prototype._=function(f,h){this.onData(f);try{var d=h.getElementsByTagName("script")[0];d.parentNode.removeChild(d)}catch(g){}};b.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(d){}this.doc=null;this.iframe.parentNode.removeChild(this.iframe);this.iframe=null;CollectGarbage()}};b.prototype.close=function(){this.destroy();return c.Transport.XHR.prototype.close.call(this)};b.check=function(){if(typeof window!="undefined"&&"ActiveXObject" in window){try{var d=new ActiveXObject("htmlfile");return d&&c.Transport.XHR.check()}catch(f){}}return false};b.xdomainCheck=function(){return false};c.transports.push("htmlfile")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports);(function(a,e,b){a["xhr-polling"]=d;function d(){e.Transport.XHR.apply(this,arguments)}e.util.inherit(d,e.Transport.XHR);e.util.merge(d,e.Transport.XHR);d.prototype.name="xhr-polling";d.prototype.open=function(){var f=this;e.Transport.XHR.prototype.open.call(f);return false};function c(){}d.prototype.get=function(){if(!this.open){return}var h=this;function g(){if(this.readyState==4){this.onreadystatechange=c;if(this.status==200){h.onData(this.responseText);h.get()}else{h.onClose()}}}function i(){this.onload=c;this.onerror=c;h.onData(this.responseText);h.get()}function f(){h.onClose()}this.xhr=this.request();if(b.XDomainRequest&&this.xhr instanceof XDomainRequest){this.xhr.onload=i;this.xhr.onerror=f}else{this.xhr.onreadystatechange=g}this.xhr.send(null)};d.prototype.onClose=function(){e.Transport.XHR.prototype.onClose.call(this);if(this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=c;try{this.xhr.abort()}catch(f){}this.xhr=null}};d.prototype.ready=function(f,h){var g=this;e.util.defer(function(){h.call(g)})};e.transports.push("xhr-polling")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);(function(b,e,d){var a=d.document&&"MozAppearance" in d.document.documentElement.style;b["jsonp-polling"]=c;function c(f){e.Transport["xhr-polling"].apply(this,arguments);this.index=e.j.length;var g=this;e.j.push(function(h){g._(h)})}e.util.inherit(c,e.Transport["xhr-polling"]);c.prototype.name="jsonp-polling";c.prototype.post=function(l){var o=this,n=e.util.query(this.socket.options.query,"t="+(+new Date)+"&i="+this.index);if(!this.form){var g=document.createElement("form"),h=document.createElement("textarea"),f=this.iframeId="socketio_iframe_"+this.index,k;g.className="socketio";g.style.position="absolute";g.style.top="-1000px";g.style.left="-1000px";g.target=f;g.method="POST";g.setAttribute("accept-charset","utf-8");h.name="d";g.appendChild(h);document.body.appendChild(g);this.form=g;this.area=h}this.form.action=this.prepareUrl()+n;function i(){j();o.socket.setBuffer(false)}function j(){if(o.iframe){o.form.removeChild(o.iframe)}try{k=document.createElement('<iframe name="'+o.iframeId+'">')}catch(p){k=document.createElement("iframe");k.name=o.iframeId}k.id=o.iframeId;o.form.appendChild(k);o.iframe=k}j();this.area.value=e.JSON.stringify(l);try{this.form.submit()}catch(m){}if(this.iframe.attachEvent){k.onreadystatechange=function(){if(o.iframe.readyState=="complete"){i()}}}else{this.iframe.onload=i}this.socket.setBuffer(true)};c.prototype.get=function(){var g=this,f=document.createElement("script"),i=e.util.query(this.socket.options.query,"t="+(+new Date)+"&i="+this.index);if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}f.async=true;f.src=this.prepareUrl()+i;f.onerror=function(){g.onClose()};var h=document.getElementsByTagName("script")[0];h.parentNode.insertBefore(f,h);this.script=f;if(a){setTimeout(function(){var j=document.createElement("iframe");document.body.appendChild(j);document.body.removeChild(j)},100)}};c.prototype._=function(f){this.onData(f);if(this.open){this.get()}return this};c.prototype.ready=function(f,h){var g=this;if(!a){return h.call(this)}e.util.load(function(){h.call(g)})};c.check=function(){return"document" in d};c.xdomainCheck=function(){return true};e.transports.push("jsonp-polling")})("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);(function(){var v=this;var s=v._;var b={};var j=Array.prototype,B=Object.prototype,E=Function.prototype;var t=j.slice,x=j.unshift,w=B.toString,p=B.hasOwnProperty;var n=j.forEach,i=j.map,z=j.reduce,e=j.reduceRight,m=j.filter,a=j.every,y=j.some,u=j.indexOf,f=j.lastIndexOf,c=Array.isArray,A=Object.keys,k=E.bind;var D=function(G){return new g(G)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=D}exports._=D}else{if(typeof define==="function"&&define.amd){define("underscore",function(){return D})}else{v._=D}}D.VERSION="1.2.2";var d=D.each=D.forEach=function(L,K,J){if(L==null){return}if(n&&L.forEach===n){L.forEach(K,J)}else{if(L.length===+L.length){for(var I=0,G=L.length;I<G;I++){if(I in L&&K.call(J,L[I],I,L)===b){return}}}else{for(var H in L){if(p.call(L,H)){if(K.call(J,L[H],H,L)===b){return}}}}}};D.map=function(J,I,H){var G=[];if(J==null){return G}if(i&&J.map===i){return J.map(I,H)}d(J,function(M,K,L){G[G.length]=I.call(H,M,K,L)});return G};D.reduce=D.foldl=D.inject=function(K,J,G,I){var H=G!==void 0;if(K==null){K=[]}if(z&&K.reduce===z){if(I){J=D.bind(J,I)}return H?K.reduce(J,G):K.reduce(J)}d(K,function(N,L,M){if(!H){G=N;H=true}else{G=J.call(I,G,N,L,M)}});if(!H){throw new TypeError("Reduce of empty array with no initial value")}return G};D.reduceRight=D.foldr=function(J,I,G,H){if(J==null){J=[]}if(e&&J.reduceRight===e){if(H){I=D.bind(I,H)}return G!==void 0?J.reduceRight(I,G):J.reduceRight(I)}var K=(D.isArray(J)?J.slice():D.toArray(J)).reverse();return D.reduce(K,I,G,H)};D.find=D.detect=function(J,I,H){var G;q(J,function(M,K,L){if(I.call(H,M,K,L)){G=M;return true}});return G};D.filter=D.select=function(J,I,H){var G=[];if(J==null){return G}if(m&&J.filter===m){return J.filter(I,H)}d(J,function(M,K,L){if(I.call(H,M,K,L)){G[G.length]=M}});return G};D.reject=function(J,I,H){var G=[];if(J==null){return G}d(J,function(M,K,L){if(!I.call(H,M,K,L)){G[G.length]=M}});return G};D.every=D.all=function(J,I,H){var G=true;if(J==null){return G}if(a&&J.every===a){return J.every(I,H)}d(J,function(M,K,L){if(!(G=G&&I.call(H,M,K,L))){return b}});return G};var q=D.some=D.any=function(J,I,H){I=I||D.identity;var G=false;if(J==null){return G}if(y&&J.some===y){return J.some(I,H)}d(J,function(M,K,L){if(G||(G=I.call(H,M,K,L))){return b}});return !!G};D.include=D.contains=function(I,H){var G=false;if(I==null){return G}if(u&&I.indexOf===u){return I.indexOf(H)!=-1}G=q(I,function(J){return J===H});return G};D.invoke=function(H,I){var G=t.call(arguments,2);return D.map(H,function(J){return(I.call?I||J:J[I]).apply(J,G)})};D.pluck=function(H,G){return D.map(H,function(I){return I[G]})};D.max=function(J,I,H){if(!I&&D.isArray(J)){return Math.max.apply(Math,J)}if(!I&&D.isEmpty(J)){return -Infinity}var G={computed:-Infinity};d(J,function(N,K,M){var L=I?I.call(H,N,K,M):N;L>=G.computed&&(G={value:N,computed:L})});return G.value};D.min=function(J,I,H){if(!I&&D.isArray(J)){return Math.min.apply(Math,J)}if(!I&&D.isEmpty(J)){return Infinity}var G={computed:Infinity};d(J,function(N,K,M){var L=I?I.call(H,N,K,M):N;L<G.computed&&(G={value:N,computed:L})});return G.value};D.shuffle=function(I){var G=[],H;d(I,function(L,J,K){if(J==0){G[0]=L}else{H=Math.floor(Math.random()*(J+1));G[J]=G[H];G[H]=L}});return G};D.sortBy=function(I,H,G){return D.pluck(D.map(I,function(L,J,K){return{value:L,criteria:H.call(G,L,J,K)}}).sort(function(M,L){var K=M.criteria,J=L.criteria;return K<J?-1:K>J?1:0}),"value")};D.groupBy=function(I,J){var G={};var H=D.isFunction(J)?J:function(K){return K[J]};d(I,function(M,K){var L=H(M,K);(G[L]||(G[L]=[])).push(M)});return G};D.sortedIndex=function(L,K,I){I||(I=D.identity);var G=0,J=L.length;while(G<J){var H=(G+J)>>1;I(L[H])<I(K)?G=H+1:J=H}return G};D.toArray=function(G){if(!G){return[]}if(G.toArray){return G.toArray()}if(D.isArray(G)){return t.call(G)}if(D.isArguments(G)){return t.call(G)}return D.values(G)};D.size=function(G){return D.toArray(G).length};D.first=D.head=function(I,H,G){return(H!=null)&&!G?t.call(I,0,H):I[0]};D.initial=function(I,H,G){return t.call(I,0,I.length-((H==null)||G?1:H))};D.last=function(I,H,G){if((H!=null)&&!G){return t.call(I,Math.max(I.length-H,0))}else{return I[I.length-1]}};D.rest=D.tail=function(I,G,H){return t.call(I,(G==null)||H?1:G)};D.compact=function(G){return D.filter(G,function(H){return !!H})};D.flatten=function(H,G){return D.reduce(H,function(I,J){if(D.isArray(J)){return I.concat(G?J:D.flatten(J))}I[I.length]=J;return I},[])};D.without=function(G){return D.difference(G,t.call(arguments,1))};D.uniq=D.unique=function(K,J,I){var H=I?D.map(K,I):K;var G=[];D.reduce(H,function(L,N,M){if(0==M||(J===true?D.last(L)!=N:!D.include(L,N))){L[L.length]=N;G[G.length]=K[M]}return L},[]);return G};D.union=function(){return D.uniq(D.flatten(arguments,true))};D.intersection=D.intersect=function(H){var G=t.call(arguments,1);return D.filter(D.uniq(H),function(I){return D.every(G,function(J){return D.indexOf(J,I)>=0})})};D.difference=function(H,G){return D.filter(H,function(I){return !D.include(G,I)})};D.zip=function(){var G=t.call(arguments);var J=D.max(D.pluck(G,"length"));var I=new Array(J);for(var H=0;H<J;H++){I[H]=D.pluck(G,""+H)}return I};D.indexOf=function(K,I,J){if(K==null){return -1}var H,G;if(J){H=D.sortedIndex(K,I);return K[H]===I?H:-1}if(u&&K.indexOf===u){return K.indexOf(I)}for(H=0,G=K.length;H<G;H++){if(K[H]===I){return H}}return -1};D.lastIndexOf=function(I,H){if(I==null){return -1}if(f&&I.lastIndexOf===f){return I.lastIndexOf(H)}var G=I.length;while(G--){if(I[G]===H){return G}}return -1};D.range=function(L,J,K){if(arguments.length<=1){J=L||0;L=0}K=arguments[2]||1;var H=Math.max(Math.ceil((J-L)/K),0);var G=0;var I=new Array(H);while(G<H){I[G++]=L;L+=K}return I};var h=function(){};D.bind=function F(J,H){var I,G;if(J.bind===k&&k){return k.apply(J,t.call(arguments,1))}if(!D.isFunction(J)){throw new TypeError}G=t.call(arguments,2);return I=function(){if(!(this instanceof I)){return J.apply(H,G.concat(t.call(arguments)))}h.prototype=J.prototype;var L=new h;var K=J.apply(L,G.concat(t.call(arguments)));if(Object(K)===K){return K}return L}};D.bindAll=function(H){var G=t.call(arguments,1);if(G.length==0){G=D.functions(H)}d(G,function(I){H[I]=D.bind(H[I],H)});return H};D.memoize=function(I,H){var G={};H||(H=D.identity);return function(){var J=H.apply(this,arguments);return p.call(G,J)?G[J]:(G[J]=I.apply(this,arguments))}};D.delay=function(H,I){var G=t.call(arguments,2);return setTimeout(function(){return H.apply(H,G)},I)};D.defer=function(G){return D.delay.apply(D,[G,1].concat(t.call(arguments,1)))};D.throttle=function(L,N){var J,G,M,K,I;var H=D.debounce(function(){I=K=false},N);return function(){J=this;G=arguments;var O=function(){M=null;if(I){L.apply(J,G)}H()};if(!M){M=setTimeout(O,N)}if(K){I=true}else{L.apply(J,G)}H();K=true}};D.debounce=function(G,I){var H;return function(){var L=this,K=arguments;var J=function(){H=null;G.apply(L,K)};clearTimeout(H);H=setTimeout(J,I)}};D.once=function(I){var G=false,H;return function(){if(G){return H}G=true;return H=I.apply(this,arguments)}};D.wrap=function(G,H){return function(){var I=[G].concat(t.call(arguments));return H.apply(this,I)}};D.compose=function(){var G=t.call(arguments);return function(){var H=t.call(arguments);for(var I=G.length-1;I>=0;I--){H=[G[I].apply(this,H)]}return H[0]}};D.after=function(H,G){if(H<=0){return G()}return function(){if(--H<1){return G.apply(this,arguments)}}};D.keys=A||function(I){if(I!==Object(I)){throw new TypeError("Invalid object")}var H=[];for(var G in I){if(p.call(I,G)){H[H.length]=G}}return H};D.values=function(G){return D.map(G,D.identity)};D.functions=D.methods=function(I){var H=[];for(var G in I){if(D.isFunction(I[G])){H.push(G)}}return H.sort()};D.extend=function(G){d(t.call(arguments,1),function(H){for(var I in H){if(H[I]!==void 0){G[I]=H[I]}}});return G};D.defaults=function(G){d(t.call(arguments,1),function(H){for(var I in H){if(G[I]==null){G[I]=H[I]}}});return G};D.clone=function(G){if(!D.isObject(G)){return G}return D.isArray(G)?G.slice():D.extend({},G)};D.tap=function(H,G){G(H);return H};function C(J,I,H){if(J===I){return J!==0||1/J==1/I}if(J==null||I==null){return J===I}if(J._chain){J=J._wrapped}if(I._chain){I=I._wrapped}if(D.isFunction(J.isEqual)){return J.isEqual(I)}if(D.isFunction(I.isEqual)){return I.isEqual(J)}var M=w.call(J);if(M!=w.call(I)){return false}switch(M){case"[object String]":return String(J)==String(I);case"[object Number]":J=+J;I=+I;return J!=J?I!=I:(J==0?1/J==1/I:J==I);case"[object Date]":case"[object Boolean]":return +J==+I;case"[object RegExp]":return J.source==I.source&&J.global==I.global&&J.multiline==I.multiline&&J.ignoreCase==I.ignoreCase}if(typeof J!="object"||typeof I!="object"){return false}var N=H.length;while(N--){if(H[N]==J){return true}}H.push(J);var L=0,G=true;if(M=="[object Array]"){L=J.length;G=L==I.length;if(G){while(L--){if(!(G=L in J==L in I&&C(J[L],I[L],H))){break}}}}else{if("constructor" in J!="constructor" in I||J.constructor!=I.constructor){return false}for(var K in J){if(p.call(J,K)){L++;if(!(G=p.call(I,K)&&C(J[K],I[K],H))){break}}}if(G){for(K in I){if(p.call(I,K)&&!(L--)){break}}G=!L}}H.pop();return G}D.isEqual=function(H,G){return C(H,G,[])};D.isEmpty=function(H){if(D.isArray(H)||D.isString(H)){return H.length===0}for(var G in H){if(p.call(H,G)){return false}}return true};D.isElement=function(G){return !!(G&&G.nodeType==1)};D.isArray=c||function(G){return w.call(G)=="[object Array]"};D.isObject=function(G){return G===Object(G)};if(w.call(arguments)=="[object Arguments]"){D.isArguments=function(G){return w.call(G)=="[object Arguments]"}}else{D.isArguments=function(G){return !!(G&&p.call(G,"callee"))}}D.isFunction=function(G){return w.call(G)=="[object Function]"};D.isString=function(G){return w.call(G)=="[object String]"};D.isNumber=function(G){return w.call(G)=="[object Number]"};D.isNaN=function(G){return G!==G};D.isBoolean=function(G){return G===true||G===false||w.call(G)=="[object Boolean]"};D.isDate=function(G){return w.call(G)=="[object Date]"};D.isRegExp=function(G){return w.call(G)=="[object RegExp]"};D.isNull=function(G){return G===null};D.isUndefined=function(G){return G===void 0};D.noConflict=function(){v._=s;return this};D.identity=function(G){return G};D.times=function(J,I,H){for(var G=0;G<J;G++){I.call(H,G)}};D.escape=function(G){return(""+G).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};D.mixin=function(G){d(D.functions(G),function(H){r(H,D[H]=G[H])})};var l=0;D.uniqueId=function(G){var H=l++;return G?G+H:H};D.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};D.template=function(J,I){var K=D.templateSettings;var G="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+J.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(K.escape,function(L,M){return"',_.escape("+M.replace(/\\'/g,"'")+"),'"}).replace(K.interpolate,function(L,M){return"',"+M.replace(/\\'/g,"'")+",'"}).replace(K.evaluate||null,function(L,M){return"');"+M.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var H=new Function("obj","_",G);return I?H(I,D):function(L){return H(L,D)}};var g=function(G){this._wrapped=G};D.prototype=g.prototype;var o=function(H,G){return G?D(H).chain():H};var r=function(G,H){g.prototype[G]=function(){var I=t.call(arguments);x.call(I,this._wrapped);return o(H.apply(D,I),this._chain)}};D.mixin(D);d(["pop","push","reverse","shift","sort","splice","unshift"],function(G){var H=j[G];g.prototype[G]=function(){H.apply(this._wrapped,arguments);return o(this._wrapped,this._chain)}});d(["concat","join","slice"],function(G){var H=j[G];g.prototype[G]=function(){return o(H.apply(this._wrapped,arguments),this._chain)}});g.prototype.chain=function(){this._chain=true;return this};g.prototype.value=function(){return this._wrapped}}).call(this);_.mixin({on:function(b,a,c){if(this.isString(b)){c=a;a=b;b=this}if(this.isUndefined(b._events)){b._events={}}if(!(a in b._events)){b._events[a]=[]}b._events[a].push(c);return this},once:function(c,a,d){if(this.isString(c)){d=a;a=c;c=this}var b=function(){_.removeEvent(c,a)};d=_.compose(b,d);this.on(c,a,d)},emit:function(f,e,b){if(this.isString(f)){b=e;e=f;f=this}if(this.isUndefined(f._events)){return}if(e in f._events){var d=f._events[e].concat();for(var c=0,a=d.length;c<a;++c){d[c].apply(f,b===undefined?[]:b)}}return this},removeEvent:function(b,a){if(this.isString(b)){a=b;b=this}if(this.isUndefined(b._events)){return}delete b._events[a]}});(function(){var k=window._;if(!String.prototype.trim){var f=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(f,"")}}function j(q,r,t,p){var s;var o=arguments.length;if(k(q).isString()){s=document.createElement(q)}var n=k(r);if(n.isArray()){s.className=r.join(" ")}else{if(n.isString()){s.className=r}}if(!k(t).isUndefined()){b(s,t)}k(p).forEach(function(v,u){s[u]=v});return s}function b(o,n){var p=k(n);if(p.isElement()||[3,11].indexOf(n.nodeType)!==-1){o.appendChild(n)}else{if(p.isArray()){p.each(function(q){b(o,q)})}else{if(p.isString()){o.appendChild(document.createTextNode(n))}else{if(p.toArray().length>0){k.each(p.toArray(),function(q){b(o,q)})}else{o.appendChild(document.createTextNode(n.toString()))}}}}}function c(n,o,p){switch(arguments.length){case 0:return function(r,q,s){return j(r,q,s)};case 1:return function(q,r){return j(n,q,r)};case 2:return function(q){return j(n,o,q)};case 3:return function(){return j(n,o,p)};default:throw"IllegalArgCount"}}function e(o){var n=(o.style)?o.style.display:"";var p=function(){o.style.display=n};o.style.display="none";return p}function d(o){var n=e(o);while(o.hasChildNodes()){o.removeChild(o.lastChild)}n()}function g(o,n){if(!o.className.match(new RegExp("\\b"+n+"\\b"))){o.className=((o.className||"")+" "+n).trim()}}function l(p,o){var n=new RegExp("\\b"+o+"\\b");if(n.test(p.className)){p.className=p.className.replace(n,"").trim()}else{p.className=(p.className+" "+o).trim()}}function i(o,n){o.className=o.className.replace(new RegExp("\\b"+n+"\\b"),"").trim()}function m(o,n){var p=k(n);var q=o.firstChild;if(p.isElement()||n.nodeType===3){o.insertBefore(n,q)}else{if(p.isArray()){p.each(function(r){m(o,r)})}else{if(p.isString()){o.insertBefore(document.createTextNode(n),q)}else{if(p.toArray().length>0){_each(p.toArray(),function(r){m(o,r)})}else{o.insertBefore(document.createTextNode(n.toString()),q)}}}}}function h(o,q,p){if(arguments.length===1){q=0;p=o.value.length}else{if(arguments.length===2){p=q}}if(o.selectionStart!==undefined){o.setSelectionRange(q,p)}else{if(o.createTextRange){var n=o.createTextRange();n.moveStart("character",q);n.moveEnd("character",p);n.select()}else{o.focus()}}}function a(p){if(p.selectionStart){return p.selectionStart}else{if(!document.selection){return 0}}var r=1,q=document.selection.createRange(),o=q.duplicate(),n=0;o.moveToElementText(p);q.text=r;n=o.text.indexOf(r);q.moveStart("character",-1);q.text="";return n}k.dom={create:j,template:c,addClass:g,removeClass:i,toggleClass:l,clear:d,hide:e,append:b,prependChild:m,select:h,cursorPos:a};k.event={cancel:function(n){if(n&&n.stopPropagation){n.preventDefault();n.stopPropagation()}else{window.event.cancelBubble=true}}};k.mixin({indexBy:function(q,p){for(var o=0,n=q.length;o<n;++o){if(p(q[o])){return o}}return -1}})}());var Message=(function(){return function(a){if(a.join){this.time=new Date();this.serv=a.addr;this.text=a.nick+" has joined.";this.chan=a.chan;this.global=true}else{if(a.topic){this.global=true;this.text=a.nick+" changed the topic to: "+a.topic;this.user=new User(a.nick)}else{if(a.part||a.quit||a.reason){this.time=new Date();this.global=true;this.text=a.nick+" has left: "+a.reason}else{if(a.oldNick){this.global=true;this.text=a.oldNick+" has changed their name to "+a.nick;this.user=new User(a.nick)}else{if(a.msg){if(a.action){this.time=new Date();this.serv=a.addr;this.chan=a.chan;this.text=a.msg;this.user=new User(a.nick);this.action=true}else{if(a.msg.indexOf("\u0001ACTION")===0){this.time=new Date();this.serv=a.addr;this.chan=a.chan;this.text=a.msg.slice(8);this.user=new User(a.nick);this.action=true}else{this.time=new Date();this.serv=a.addr;this.text=a.msg;this.chan=a.chan;this.user=new User(a.nick)}}}else{console.log("Unknown type.")}}}}}return this}}());var MessageView=(function(){var a=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?]))/ig;function b(h){var d=["message"];if(h.mono){d.push("mono")}if(h.mentioned){d.push("mentioned")}if(h.action){d.push("action")}var i=_.dom.template("td"),e;if(h.global){d.push("status");var c=i("message",h.text);c.colSpan=3;e=_.dom.create("tr",d,c)}else{if(h.user){var g=h.text;var f=i("message",g);f.innerHTML=f.innerHTML.replace(a,"<a href='$&' target='_blank'>$&</a>");e=_.dom.create("tr",d,[i("time",h.time.toLocaleTimeString()),i("sender",(h.user)?h.user.nick:""),f]);_.dom.prependChild(e.querySelector(".sender"),_.dom.create("span","prefix",h.user.prefix))}else{d.push("status");var c=i("sender","User");c.innerHTML+="&nbsp;";e=_.dom.create("tr",d,[i("time"),c,i("message",h.text)])}}return e}return function(c){this._msg=c;this.el=b(c)}}());var Chan=(function(){return function(a){this.name=a.name;this.topic=a.topic||"";this.users=a.users||{};this.messages=a.messages||[]}}());Chan.prototype.addMessage=function(a){this.addMessages([a])};Chan.prototype.addMessages=function(b){var a=this;_(b).each(function(c){if(c.user){c.user.prefix=this.users[c.user.nick]}this.messages.push(c)},this);_(this).emit("new-msgs",[[],b])};Chan.prototype.preMessages=function(a){_(a).each(function(b){this.messages.unshift(b)},this);_(this).emit("new-msgs",[a,[]])};Chan.prototype.setTopic=function(a,b){this.topic={str:a,nick:b};_(this).emit("new-topic")};Chan.prototype.addUsers=function(b){var a=this;_(b).forEach(function(d,c){a.users[c]=d})};var ChanView=(function(){return function(e){var f=_.dom,d={li:f.create("li",["chan"],e.name),messages:f.create("div",["log_container","is-selectable"],f.create("table",["log"],f.create("tbody")))},b=this;var a=d.messages;var c=d.messages.getElementsByTagName("tbody")[0];_(e.messages).each(function(g){c.appendChild(new MessageView(g).el)});_(e).on("new-msgs",function(g,h){var i=a.scrollTop===(a.scrollHeight-a.clientHeight);_(g).each(function(j){_.dom.prependChild(c,new MessageView(j).el)},b);_(h).each(function(j){c.appendChild(new MessageView(j).el)},b);if(i){a.scrollTop=a.scrollHeight}});_(e).on("mentioned",function(){if(!b.active){b.mention()}});_(e).on("removed",function(){_(b).emit("removed")});_(e).on("new-topic",function(){if(b.active){_.emit("new-topic",[e])}});d.li.onclick=function(){_.emit("new-active-chan",[b]);b.activate()};this.el=d;this.active=false;this.mentioned=false;this.chan=e}}());ChanView.prototype.activate=function(){_.dom.addClass(this.el.li,"is-active");this.active=true;this.unmention()};ChanView.prototype.deactivate=function(){_.dom.removeClass(this.el.li,"is-active");this.active=false};ChanView.prototype.mention=function(){_.dom.addClass(this.el.li,"is-interesting");this.mentioned=true};ChanView.prototype.unmention=function(){if(this.mentioned){this.mentioned=false;_.dom.removeClass(this.el.li,"is-interesting")}};var Server=(function(){return function(a){var b=new RegExp("\\b"+a.nick+"\\b","i");this.name=a.name;this.addr=a.addr;this.nick=a.nick;this._nick=b;this.chans=a.chans||[];this.users=a.users||[];this.main=a.main||new Chan({});this.getChan=function(d){var c=_.filter(this.chans,function(e){return e.name===d});if(c.length>0){return c[0]}};this.newChan=function(d){if(!_(this.chans).any(function(e){return e.name===d.name})){d.nick=this.nick;var c=new Chan(d);this.chans.push(c);_(this).emit("new-chan",[c]);return c}};this.removeChan=function(c){var d=_(this.chans);var f=d.filter(function(g){return g.name===c});if(f.length>0){var e=f[0];_(e).emit("removed");this.chans=d.filter(function(g){g.name!==c})}}}}());Server.prototype.changeNick=function(a){this.nick=a;this._nick=new RegExp("\\b"+a+"\\b","i")};Server.prototype.addMessage=function(a){this.addMessages([a])};Server.prototype.addMessages=function(a){_(a).each(function(f){if(f.global){this.main.addMessage(f)}else{if(f instanceof Message){var e=_(this.chans).find(function(g){return g.name===f.chan});if(this._nick.test(f.text)){_(e).emit("mentioned");_(this).emit("mentioned");f.mentioned=true;var d=f.text.split(this._nick),c=[],b=_.dom.template("span","mention",this.nick);_.each(d,function(g){c.push(document.createTextNode(g));c.push(b())});c.pop();f.text=c}if(e){e.addMessage(f)}}else{return"Not a message."}}},this)};var ServerView=(function(){function a(d,f){var e=_.dom;var c={li:e.create("li",["serv"],f.name),chans:e.create("ul",["chans"])};d.main=new ChanView(f.main);var b=_.map(f.chans,function(g){return new ChanView(g)});d._chanViews=b;_.each(b,function(g){c.chans.appendChild(g.el.li)});if(b.length>0){b[0].activate()}c.li.onclick=function(){if(d.active){_.emit("new-active-chan",[d.main])}else{_.emit("new-active-serv",[d])}};d.el=c}return function(e){a(this,e);var b=this._chanViews,d=this.el,c=this;_(e).on("new-chan",function(h){var f=new ChanView(h);if(b.length>0){var g=_.indexBy(b,function(i){return i.active});b.splice(g+1,0,f);d.chans.insertBefore(f.el.li,d.chans.childNodes[g].nextSibling)}else{b.push(f);_.dom.prependChild(d.chans,f.el.li);_.emit("new-active-chan",[f])}_(f).on("removed",function(){d.chans.removeChild(f.el.li);b=_(b).filter(function(i){return f!==i})})});_(e).on("mentioned",function(){if(!c.active){c.mention()}});this.serv=e}}());ServerView.prototype.getActiveChanView=function(){var a=_(this._chanViews).find(function(b){return b.active});return a?a:this.main};ServerView.prototype.activate=function(){_.dom.addClass(this.el.li,"is-active");this.active=true;this.unmention()};ServerView.prototype.deactivate=function(){_.dom.removeClass(this.el.li,"is-active");this.active=false};ServerView.prototype.mention=function(){_.dom.addClass(this.el.li,"is-interesting");this.mentioned=true};ServerView.prototype.unmention=function(){if(this.mentioned){this.mentioned=false;_.dom.removeClass(this.el.li,"is-interesting")}};var User=function(a,d,b,c){this.nick=a;this.user=d;this.host=b;this.prefix=c;this.privileges=[]};var ModalChanWindow=(function(){var b=_.dom.create;var a=_.dom.append;return function(){var h=document.createDocumentFragment();var d=b("label",[],"chan");d["for"]="chan-name";var e=b("input",[],[],{type:"text",id:"chan-name",name:"chan-name",autofocus:true});var f=b("input",[],undefined,{type:"button",value:"Join"});var c=function(){App.join(View.getActiveServerView().serv.addr,e.value);View.hideModal()};var g=function(i){if(i.keyCode===13){if(e.value){c()}}};a(h,[b("h1",[],"Join"),b("p",[],[d,e]),b("p",[],[f])]);this.el=b("div","modal",h);this.el.id="newChan";if(f.addEventListener){this.el.addEventListener("click",_.event.cancel);f.addEventListener("click",c);e.addEventListener("keydown",g)}else{this.el.attachEvent("onclick",_.event.cancel);f.attachEvent("onclick",c);e.attachEvent("onkeydown",g)}return this}}());var ModalServWindow=(function(){var b=_.dom.create;var a=_.dom.append;return function(){var l=document.createDocumentFragment();var i=b("label",[],"Server");i["for"]="serv-addr";var k=b("input",[],[],{type:"text",name:"addr",id:"serv-addr",autofocus:true});var g=b("label",[],"Name");i["for"]="serv-name";var e=b("input",[],[],{type:"text",name:"name",id:"serv-name"});var f=b("label",[],"Nick");f["for"]="serv-nick";var j=b("input",[],[],{name:"nick",id:"serv-nick"});var m=b("input",[],undefined,{type:"button",value:"Connect"});a(l,[b("h1",[],"Connect"),b("p",[],[i,k]),b("p",[],[g,e]),b("p",[],[f,j]),b("p",[],[m])]);var h=[k,e,j];this.el=b("div","modal",l);this.el.id="newServ";var d=function(n){if(this===k){e.value=getLongestSubstr(k.value)}if(n.keyCode===13){if(k.value&&e.value&&j){c()}}};var c=function(){App.serverName(k.value,e.value);App.connect(k.value,[],j.value);View.hideModal()};if(this.el.addEventListener){this.el.addEventListener("click",_.event.cancel);_.forEach(h,function(n){n.addEventListener("keydown",d)});m.addEventListener("click",c)}else{this.el.attachEvent("onclick",_.event.cancel);_.forEach(h,function(n){n.attachEvent("onkeydown",d)});m.attachEvent("onclick",c)}return this}}());var DefaultServerView=(function(){var a=_.dom.create("ul");return function(){this.el={chans:a}}}());var MainChanView=(function(){var a=_.dom.create("div");return function(){this.el={messages:a}}}());DefaultServerView.prototype.getActiveChanView=(function(){var a={el:{messages:_.dom.create("div")}};return function(){return a}}());DefaultServerView.prototype.deactivate=function(){};MainChanView.prototype.deactivate=function(){};DefaultServerView.prototype.activate=function(){};MainChanView.prototype.activate=function(){};var Irc=(function(){return function(c){var b=_.dom;var a={body:document.body,newChan:(function(){var d=b.create("div","modal");d.id="chan_modal";return d}()),newServ:(function(){var d=b.create("div","modal");d.id="serv_modal";return d}())};this.servers=[];this.conns=(c)?{irc:io.connect(c+"/irc")}:{};this.handle();this.el=a;this.addServer=function(e){var d=_.find(this.servers,function(f){return f.addr===e.addr});if(!d){this.servers.push(e);_(this).emit("new-server",[e])}};this.getServer=function(d){var d=_.filter(this.servers,function(e){return e.addr===d});if(d.length>0){return d[0]}};this.serverNames={}}}());function getLongestSubstr(a){var c=0;var b="";var d="";while(c<a.length){d="";while(c<a.length&&a[c]!=="."){d+=a[c];c++}if(d.length>b.length){b=d}while(c<a.length&&a[c]==="."){c++}}return b}Irc.prototype.handle=function(){var b=this;var a=this.conns.irc;a.on("registered",function(c){b.addServer(new Server({name:b.serverNames[c.addr]||getLongestSubstr(c.addr),addr:c.addr,nick:c.nick}))});a.on("join",function(d){var e=b.getServer(d.addr);var c=e.getChan(d.chan);if(!c){c=e.newChan({name:d.chan})}d.join=true;c.addMessage(new Message(d))});a.on("message",function(c){b.getServer(c.addr).addMessage(new Message(c))});a.on("topic",function(d){var c=b.getServer(d.addr).getChan(d.chan);c.setTopic(d.topic,d.nick)});a.on("quit",function(d){var c=b.getServer(d.addr);d.quit=true;_.forEach(d.chans,function(e){c.getChan(e).addMessage(new Message(d))})});a.on("part",function(e){var d=b.getServer(e.addr);e.part=true;if(e.nick===d.nick){d.removeChan(e.chan)}else{var c=d.getChan(e.chan);c.addMessage(new Message(e))}});a.on("names",function(d){var c=b.getServer(d.addr).getChan(d.chan);c.addUsers(d.names)});a.on("disconnect",function(){_.emit("disconnected",[])});a.on("nick",function(c){var d=b.getServer(c.addr);if(d){if(d.nick===c.oldNick){d.changeNick(c.nick)}_.forEach(c.chans,function(e){var e=d.getChan(e);if(e){e.addMessage(new Message(c))}})}})};Irc.prototype.join=function(a,b){this.conns.irc.emit("join",{addr:a,chan:b})};Irc.prototype.connect=function(c,b,a){this.conns.irc.emit("connect",{addr:c,chans:b||[],nick:a})};Irc.prototype.serverName=function(b,a){this.serverNames[b]=a};var IrcView=(function(){var c=_.dom,b=_.dom.append;function a(i,g){var f={body:document.body,modal:c.create("div"),modChan:new ModalChanWindow(),modServ:new ModalServWindow(),servList:c.create("ul",["servs"]),newServ:c.create("li",["serv","nonitem"],"+"),newChan:c.create("li",["chan","nonitem"],"+"),header:c.create("header",["connection-list"]),input:c.create("input",["chat","is-selectable"]),gradient:c.create("div")};f.body.appendChild(f.modal);f.gradient.id="gradient";f.modal.id="modal";f.input.autofocus=true;i.el=f;i.history={messages:[],position:0,current:""};var h=i.hideModal=function(){c.removeClass(f.modal,"show");c.clear(f.modal);f.input.hide()};if(f.modal.addEventListener){f.modal.addEventListener("click",h,false)}else{f.modal.attachEvent("onclick",h)}i._defaultServ=new DefaultServerView();var e=_.map(g.servers,function(l){return new ServerView(l)});if(e.length>0){e[0].activate()}_.each(e,function(l){b(f.servList,l.el.li)});f.servList.appendChild(f.newServ);i._serverViews=e;f.newServ.onclick=function(){b(f.modal,f.modServ.el);c.addClass(f.modal,"show")};f.newChan.onclick=function(){b(f.modal,f.modChan.el);c.addClass(f.modal,"show")};var k=i.getActiveServerView();f.chanList=k.el.chans;b(f.header,[f.servList,f.chanList,f.gradient]);b(f.body,[f.header,k.getActiveChanView().el.messages,f.input]);var d={tab:9,enter:13,up:38,down:40};var j=function(v){if(v.keyCode===d.tab){var l=_.dom.cursorPos(this);var x=this.value.substring(0,l);var t=/\w*?$/.exec(x);var m=i.getActiveServerView().getActiveChanView().chan.users;var s=[];if(t){var y=t[0].toLowerCase();_.forEach(m,function(A,z){if(z.toLowerCase().indexOf(y)===0){s.push(z)}});s.sort();if(s.length===1){this.value=x+s[0].substring(t[0].length,s[0].length)+this.value.substring(l,this.value.length)+": ";_.dom.select(this,this.value.length)}else{if(s.length>1){console.log(s)}}}_.event.cancel(v)}else{if(v.keyCode===d.enter){var p=i.getActiveServerView();var u=p.getActiveChanView();var w=p.serv.addr;var o=u.chan.name;var n=this.value;var q={addr:w,chan:o,nick:p.serv.nick};if(n.toLowerCase().indexOf("/me ")===0){q.msg=n.slice(4);g.conns.irc.emit("action",q)}else{q.msg=n;g.conns.irc.emit("say",q)}i.history.messages.unshift(n);i.history.position=-1;this.value=""}else{if(v.keyCode===d.up){var r=++i.history.position;if(r===0){i.history.current=this.value}if(r<i.history.messages.length){this.value=i.history.messages[r]}else{i.history.position--}console.log("Selecting.");_.dom.select(this);_.event.cancel(v)}else{if(v.keyCode===d.down){var r=--i.history.position;if(r===-1){this.value=i.history.current;i.history.current="";_.dom.select(this,this.value.length)}else{this.value=i.history.messages[r];console.log("Selecting.");_.dom.select(this)}_.event.cancel(v)}}}}};if(f.input.addEventListener){f.input.addEventListener("keydown",j,false)}else{f.input.attachEvent("onkeydown",j)}i._serverViews=e}return function(e){a(this,e);var g=this.el,d=this,f=this._serverViews;_.on("new-active-chan",function(i){var h=d.getActiveServerView().getActiveChanView();h.deactivate();i.activate();g.body.replaceChild(i.el.messages,h.el.messages);i.el.messages.style.bottom=g.input.offsetHeight+"px";i.el.messages.style.top=g.header.offsetHeight+"px";g.gradient.innerHTML=i.chan.topic.str;g.gradient.title="Set by "+i.chan.topic.nick});_.on("new-topic",function(h){g.gradient.innerHTML=h.topic.str;g.gradient.title="Set by "+h.topic.nick});_.on("new-active-serv",function(k){var h=d.getActiveServerView();h.deactivate();k.activate();var j=h.getActiveChanView();var i=k.getActiveChanView();g.body.replaceChild(i.el.messages,j.el.messages);g.header.replaceChild(k.el.chans,h.el.chans);b(k.el.chans,g.newChan);i.el.messages.style.bottom=g.input.offsetHeight+"px";i.el.messages.style.top=g.header.offsetHeight+"px";g.gradient.innerHTML=i.chan.topic.str;g.gradient.title="Set by "+i.chan.topic.nick});_.on("disconnected",function(){d.getActiveServerView().getActiveChanView().chan.addMessage(new Message({msg:"Disconnected.",action:true,nick:""}))});_(e).on("new-server",function(j){var h=new ServerView(j);if(f.length>0){var i=_.indexBy(f,function(k){return k.active===true});f.splice(i+1,0,h);g.servList.insertBefore(h.el.li,g.servList.childNodes[i+1])}else{f.push(h);_.dom.prependChild(g.servList,h.el.li);_.emit("new-active-serv",[h]);h.activate()}})}}());IrcView.prototype.getActiveServerView=function(){var a=_.find(this._serverViews,function(b){return b.active});return a?a:this._defaultServ};
/*!
 * goIRC Frontend v0.4.0
 *
 * Copyright 2012, Robert Wertman
 *
 * Date: Wed Mar 07 20:52:00 2012 -0500
 */
window.App=new Irc(":33111");window.View=new IrcView(window.App);
