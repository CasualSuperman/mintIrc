var i=void 0,n=!0,p=null,s=!1;
(function(){function a(c,h){d.prototype[c]=function(){var c=m.call(arguments);S.call(c,this.z);return e(h.apply(b,c),this.L)}}function e(c,h){return h?b(c).xa():c}function d(c){this.z=c}function g(){}function b(c){return new d(c)}function j(c,h,a){if(c===h)return 0!==c||1/c==1/h;if(c==p||h==p)return c===h;c.L&&(c=c.z);h.L&&(h=h.z);if(b.O(c.isEqual))return c.isEqual(h);if(b.O(h.isEqual))return h.isEqual(c);var f=t.call(c);if(f!=t.call(h))return s;switch(f){case "[object String]":return""+c==""+h;case "[object Number]":return c=
+c,h=+h,c!=c?h!=h:0==c?1/c==1/h:c==h;case "[object Date]":case "[object Boolean]":return+c==+h;case "[object RegExp]":return c.source==h.source&&c.global==h.global&&c.multiline==h.multiline&&c.ignoreCase==h.ignoreCase}if("object"!=typeof c||"object"!=typeof h)return s;for(var d=a.length;d--;)if(a[d]==c)return n;a.push(c);var d=0,e=n;if("[object Array]"==f){if(d=c.length,e=d==h.length)for(;d--&&(e=d in c==d in h&&j(c[d],h[d],a)););}else{if("constructor"in c!="constructor"in h||c.constructor!=h.constructor)return s;
for(var g in c)if(u.call(c,g)&&(d++,!(e=u.call(h,g)&&j(c[g],h[g],a))))break;if(e){for(g in h)if(u.call(h,g)&&!d--)break;e=!d}}a.pop();return e}var f=this,k=f.R,o={},l=Array.prototype,q=Object.prototype,m=l.slice,S=l.unshift,t=q.toString,u=q.hasOwnProperty,I=l.forEach,A=l.map,J=l.reduce,K=l.reduceRight,L=l.filter,M=l.every,N=l.some,B=l.indexOf,O=l.lastIndexOf,q=Array.isArray,T=Object.keys,E=Function.prototype.bind;"undefined"!==typeof exports?("undefined"!==typeof module&&module.Ea&&(exports=module.Ea=
b),exports.R=b):"function"===typeof define&&define.Va?define("underscore",function(){return b}):f.R=b;b.VERSION="1.2.2";var r=b.m=b.forEach=function(c,b,a){if(c!=p)if(I&&c.forEach===I)c.forEach(b,a);else if(c.length===+c.length)for(var d=0,e=c.length;d<e;d++){if(d in c&&b.call(a,c[d],d,c)===o)break}else for(d in c)if(u.call(c,d)&&b.call(a,c[d],d,c)===o)break};b.map=function(c,b,a){var d=[];if(c==p)return d;if(A&&c.map===A)return c.map(b,a);r(c,function(c,e,f){d[d.length]=b.call(a,c,e,f)});return d};
b.reduce=b.ab=b.gb=function(c,h,a,d){var e=a!==i;c==p&&(c=[]);if(J&&c.reduce===J){d&&(h=b.bind(h,d));return e?c.reduce(h,a):c.reduce(h)}r(c,function(c,b,f){if(e)a=h.call(d,a,c,b,f);else{a=c;e=n}});if(!e)throw new TypeError("Reduce of empty array with no initial value");return a};b.reduceRight=b.bb=function(c,h,a,d){c==p&&(c=[]);if(K&&c.reduceRight===K){d&&(h=b.bind(h,d));return a!==i?c.reduceRight(h,a):c.reduceRight(h)}c=(b.isArray(c)?c.slice():b.w(c)).reverse();return b.reduce(c,h,a,d)};b.find=b.Za=
function(c,b,a){var d;P(c,function(c,e,f){if(b.call(a,c,e,f)){d=c;return n}});return d};b.filter=b.select=function(c,b,a){var d=[];if(c==p)return d;if(L&&c.filter===L)return c.filter(b,a);r(c,function(c,e,f){b.call(a,c,e,f)&&(d[d.length]=c)});return d};b.xb=function(c,b,a){var d=[];if(c==p)return d;r(c,function(c,e,f){b.call(a,c,e,f)||(d[d.length]=c)});return d};b.every=b.all=function(c,b,a){var d=n;if(c==p)return d;if(M&&c.every===M)return c.every(b,a);r(c,function(c,e,f){if(!(d=d&&b.call(a,c,e,
f)))return o});return d};var P=b.some=b.wa=function(c,a,d){var a=a||b.T,e=s;if(c==p)return e;if(N&&c.some===N)return c.some(a,d);r(c,function(c,b,f){if(e||(e=a.call(d,c,b,f)))return o});return!!e};b.na=b.contains=function(c,b){var a=s;if(c==p)return a;if(B&&c.indexOf===B)return c.indexOf(b)!=-1;return a=P(c,function(c){return c===b})};b.jb=function(c,a){var d=m.call(arguments,2);return b.map(c,function(c){return(a.call?a||c:c[a]).apply(c,d)})};b.da=function(c,a){return b.map(c,function(c){return c[a]})};
b.max=function(c,a,d){if(!a&&b.isArray(c))return Math.max.apply(Math,c);if(!a&&b.pa(c))return-Infinity;var e={M:-Infinity};r(c,function(c,b,f){b=a?a.call(d,c,b,f):c;b>=e.M&&(e={value:c,M:b})});return e.value};b.min=function(c,a,d){if(!a&&b.isArray(c))return Math.min.apply(Math,c);if(!a&&b.pa(c))return Infinity;var e={M:Infinity};r(c,function(c,b,f){b=a?a.call(d,c,b,f):c;b<e.M&&(e={value:c,M:b})});return e.value};b.zb=function(c){var b=[],a;r(c,function(c,d){if(d==0)b[0]=c;else{a=Math.floor(Math.random()*
(d+1));b[d]=b[a];b[a]=c}});return b};b.Ab=function(c,a,d){return b.da(b.map(c,function(c,b,e){return{value:c,ja:a.call(d,c,b,e)}}).sort(function(c,b){var a=c.ja,d=b.ja;return a<d?-1:a>d?1:0}),"value")};b.cb=function(c,a){var d={},e=b.O(a)?a:function(c){return c[a]};r(c,function(c,b){var a=e(c,b);(d[a]||(d[a]=[])).push(c)});return d};b.Qa=function(c,a){var d;d||(d=b.T);for(var e=0,f=c.length;e<f;){var g=e+f>>1;d(c[g])<d(a)?e=g+1:f=g}return e};b.w=function(c){return!c?[]:c.w?c.w():b.isArray(c)||b.Ga(c)?
m.call(c):b.Sa(c)};b.size=function(c){return b.w(c).length};b.$a=b.head=function(c,b,a){return b!=p&&!a?m.call(c,0,b):c[0]};b.fb=function(c,b,a){return m.call(c,0,c.length-(b==p||a?1:b))};b.Ia=function(c){return c[c.length-1]};b.yb=b.Bb=function(c,b,a){return m.call(c,b==p||a?1:b)};b.compact=function(c){return b.filter(c,function(c){return!!c})};b.ka=function(c,a){return b.reduce(c,function(c,d){if(b.isArray(d))return c.concat(a?d:b.ka(d));c[c.length]=d;return c},[])};b.Ib=function(c){return b.Da(c,
m.call(arguments,1))};b.sa=b.unique=function(c,a,d){var d=d?b.map(c,d):c,e=[];b.reduce(d,function(d,f,g){if(0==g||(a===n?b.Ia(d)!=f:!b.na(d,f))){d[d.length]=f;e[e.length]=c[g]}return d},[]);return e};b.Gb=function(){return b.sa(b.ka(arguments,n))};b.ib=b.hb=function(c){var a=m.call(arguments,1);return b.filter(b.sa(c),function(c){return b.every(a,function(a){return b.indexOf(a,c)>=0})})};b.Da=function(c,a){return b.filter(c,function(c){return!b.na(a,c)})};b.Kb=function(){for(var c=m.call(arguments),
a=b.max(b.da(c,"length")),d=Array(a),e=0;e<a;e++)d[e]=b.da(c,""+e);return d};b.indexOf=function(c,a,d){if(c==p)return-1;var e;if(d){d=b.Qa(c,a);return c[d]===a?d:-1}if(B&&c.indexOf===B)return c.indexOf(a);d=0;for(e=c.length;d<e;d++)if(c[d]===a)return d;return-1};b.lastIndexOf=function(c,b){if(c==p)return-1;if(O&&c.lastIndexOf===O)return c.lastIndexOf(b);for(var a=c.length;a--;)if(c[a]===b)return a;return-1};b.wb=function(c,b,a){if(arguments.length<=1){b=c||0;c=0}for(var a=arguments[2]||1,d=Math.max(Math.ceil((b-
c)/a),0),e=0,f=Array(d);e<d;){f[e++]=c;c=c+a}return f};b.bind=function(c,a){var d,e;if(c.bind===E&&E)return E.apply(c,m.call(arguments,1));if(!b.O(c))throw new TypeError;e=m.call(arguments,2);return d=function(){if(!(this instanceof d))return c.apply(a,e.concat(m.call(arguments)));g.prototype=c.prototype;var b=new g,f=c.apply(b,e.concat(m.call(arguments)));return Object(f)===f?f:b}};b.Wa=function(c){var a=m.call(arguments,1);a.length==0&&(a=b.la(c));r(a,function(a){c[a]=b.bind(c[a],c)});return c};
b.rb=function(c,a){var d={};a||(a=b.T);return function(){var b=a.apply(this,arguments);return u.call(d,b)?d[b]:d[b]=c.apply(this,arguments)}};b.Ca=function(c,b){var a=m.call(arguments,2);return setTimeout(function(){return c.apply(c,a)},b)};b.defer=function(c){return b.Ca.apply(b,[c,1].concat(m.call(arguments,1)))};b.Db=function(c,a){var d,e,f,g,k,o=b.Ba(function(){k=g=s},a);return function(){d=this;e=arguments;f||(f=setTimeout(function(){f=p;k&&c.apply(d,e);o()},a));g?k=n:c.apply(d,e);o();g=n}};
b.Ba=function(c,b){var a;return function(){var d=this,e=arguments;clearTimeout(a);a=setTimeout(function(){a=p;c.apply(d,e)},b)}};b.La=function(c){var b=s,a;return function(){if(b)return a;b=n;return a=c.apply(this,arguments)}};b.Jb=function(c,b){return function(){var a=[c].concat(m.call(arguments));return b.apply(this,a)}};b.za=function(){var c=m.call(arguments);return function(){for(var b=m.call(arguments),a=c.length-1;a>=0;a--)b=[c[a].apply(this,b)];return b[0]}};b.Ua=function(c,b){return c<=0?
b():function(){if(--c<1)return b.apply(this,arguments)}};b.keys=T||function(c){if(c!==Object(c))throw new TypeError("Invalid object");var b=[],a;for(a in c)u.call(c,a)&&(b[b.length]=a);return b};b.Sa=function(c){return b.map(c,b.T)};b.la=b.sb=function(c){var a=[],d;for(d in c)b.O(c[d])&&a.push(d);return a.sort()};b.extend=function(c){r(m.call(arguments,1),function(b){for(var a in b)b[a]!==i&&(c[a]=b[a])});return c};b.Ya=function(c){r(m.call(arguments,1),function(b){for(var a in b)c[a]==p&&(c[a]=b[a])});
return c};b.Xa=function(c){return!b.Ha(c)?c:b.isArray(c)?c.slice():b.extend({},c)};b.Cb=function(c,b){b(c);return c};b.isEqual=function(c,b){return j(c,b,[])};b.pa=function(c){if(b.isArray(c)||b.r(c))return c.length===0;for(var a in c)if(u.call(c,a))return s;return n};b.mb=function(){return s};b.isArray=q||function(c){return t.call(c)=="[object Array]"};b.Ha=function(c){return c===Object(c)};b.Ga="[object Arguments]"==t.call(arguments)?function(c){return t.call(c)=="[object Arguments]"}:function(c){return!(!c||
!u.call(c,"callee"))};b.O=function(c){return t.call(c)=="[object Function]"};b.r=function(c){return t.call(c)=="[object String]"};b.pb=function(c){return t.call(c)=="[object Number]"};b.nb=function(c){return c!==c};b.kb=function(c){return c===n||c===s||t.call(c)=="[object Boolean]"};b.lb=function(c){return t.call(c)=="[object Date]"};b.qb=function(c){return t.call(c)=="[object RegExp]"};b.ob=function(c){return c===p};b.U=function(c){return c===i};b.vb=function(){f.R=k;return this};b.T=function(c){return c};
b.Eb=function(c,b,a){for(var d=0;d<c;d++)b.call(a,d)};b.escape=function(c){return(""+c).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};b.ba=function(c){r(b.la(c),function(d){a(d,b[d]=c[d])})};var U=0;b.Hb=function(c){var b=U++;return c?c+b:b};b.Ra={evaluate:/<%([\s\S]+?)%>/g,Fa:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};b.fa=function(c,a){var d=b.Ra,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+
c.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.escape,function(c,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(d.Fa,function(c,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||p,function(c,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return a?e(a,b):function(c){return e(c,b)}};b.prototype=d.prototype;b.ba(b);r("pop,push,reverse,shift,sort,splice,unshift".split(","),
function(c){var b=l[c];d.prototype[c]=function(){b.apply(this.z,arguments);return e(this.z,this.L)}});r(["concat","join","slice"],function(c){var b=l[c];d.prototype[c]=function(){return e(b.apply(this.z,arguments),this.L)}});d.prototype.xa=function(){this.L=n;return this};d.prototype.value=function(){return this.z}}).call(this);_.ba({h:function(a,e,d){this.r(a)&&(d=e,e=a,a=this);this.U(a.p)&&(a.p={});e in a.p||(a.p[e]=[]);a.p[e].push(d);return this},La:function(a,e,d){this.r(a)&&(d=e,e=a,a=this);d=_.za(function(){_.Pa(a,e)},d);this.h(a,e,d)},i:function(a,e,d){this.r(a)&&(d=e,e=a,a=this);if(!this.U(a.p)){if(e in a.p)for(var e=a.p[e].concat(),g=0,b=e.length;g<b;++g)e[g].apply(a,d===i?[]:d);return this}},Pa:function(a,e){this.r(a)&&(e=a,a=this);this.U(a.p)||delete a.p[e]}});(function(){function a(a,d,g,l){var q;b(a).r()&&(q=document.createElement(a));a=b(d);a.isArray()?q.className=d.join(" "):a.r()&&(q.className=d);b(g).U()||e(q,g);b(l).forEach(function(b,a){q[a]=b});return q}function e(a,d){var g=b(d);-1!==[3,11].indexOf(d.nodeType)?a.appendChild(d):g.isArray()?g.m(function(b){e(a,b)}):g.r()?a.appendChild(document.createTextNode(d)):0<g.w().length?b.m(g.w(),function(b){e(a,b)}):a.appendChild(document.createTextNode(d.toString()))}function d(b){var a=b.style?b.style.display:
"";b.style.display="none";return function(){b.style.display=a}}function g(a,d){var e=b(d),l=a.firstChild;3===d.nodeType?a.insertBefore(d,l):e.isArray()?e.m(function(b){g(a,b)}):e.r()?a.insertBefore(document.createTextNode(d),l):0<e.w().length?_each(e.w(),function(b){g(a,b)}):a.insertBefore(document.createTextNode(d.toString()),l)}var b=window.R;if(!String.prototype.trim){var j=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(j,"")}}b.b={create:a,fa:function(b,d,e){switch(arguments.length){case 0:return function(b,
d,e){return a(b,d,e)};case 1:return function(d,e){return a(b,d,e)};case 2:return function(e){return a(b,d,e)};case 3:return function(){return a(b,d,e)};default:throw"IllegalArgCount";}},D:function(b,a){b.className.match(RegExp("\\b"+a+"\\b"))||(b.className=((b.className||"")+" "+a).trim())},Q:function(b,a){b.className=b.className.replace(RegExp("\\b"+a+"\\b"),"").trim()},Fb:function(b,a){var d=RegExp("\\b"+a+"\\b");b.className=d.test(b.className)?b.className.replace(d,"").trim():(b.className+" "+
a).trim()},clear:function(b){for(var a=d(b);b.hasChildNodes();)b.removeChild(b.lastChild);a()},eb:d,append:e,V:g,select:function(b,a,d){1===arguments.length?(a=0,d=b.value.length):2===arguments.length&&(d=a);if(b.selectionStart!==i)b.setSelectionRange(a,d);else if(b.createTextRange){var e=b.createTextRange();e.moveStart("character",a);e.moveEnd("character",d);e.select()}else b.focus()},Aa:function(b){if(b.selectionStart)return b.selectionStart;if(!document.selection)return 0;var a=document.selection.createRange(),
d=a.duplicate(),e=0;d.moveToElementText(b);a.text=1;e=d.text.indexOf(1);a.moveStart("character",-1);a.text="";return e}};b.event={cancel:function(b){b&&b.stopPropagation?(b.preventDefault(),b.stopPropagation()):window.event.cancelBubble=n}};b.ba({oa:function(b,a){for(var d=0,e=b.length;d<e;++d)if(a(b[d]))return d;return-1}})})();function v(a){a.join?(this.time=new Date,this.C=a.d,this.text=a.c+" has joined.",this.e=a.e,this.global=n):a.o?(this.global=n,this.text=a.c+" changed the topic to: "+a.o,this.l=new w(a.c)):a.Ma||a.Na||a.reason?(this.time=new Date,this.global=n,this.text=a.c+" has left: "+a.reason):a.qa?(this.global=n,this.text=a.qa+" has changed their name to "+a.c,this.l=new w(a.c)):a.B?a.action?(this.time=new Date,this.C=a.d,this.e=a.e,this.text=a.B,this.l=new w(a.c),this.action=n):0===a.B.indexOf("\u0001ACTION")?
(this.time=new Date,this.C=a.d,this.e=a.e,this.text=a.B.slice(8),this.l=new w(a.c),this.action=n):(this.time=new Date,this.C=a.d,this.text=a.B,this.e=a.e,this.l=new w(a.c)):console.log("Unknown type.");return this};var x=function(){var a=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/ig;return function(e){var d=["message"];e.tb&&d.push("mono");e.v&&d.push("mentioned");e.action&&d.push("action");var g=_.b.fa("td");if(e.global){d.push("status");var b=g("message",e.text);b.colSpan=3;d=_.b.create("tr",d,b)}else e.l?(b=g("message",
e.text),b.innerHTML=b.innerHTML.replace(a,"<a href='$&' target='_blank'>$&</a>"),d=_.b.create("tr",d,[g("time",e.time.toLocaleTimeString()),g("sender",e.l?e.l.c:""),b]),_.b.V(d.querySelector(".sender"),_.b.create("span","prefix",e.l.prefix))):(d.push("status"),b=g("sender","User"),b.innerHTML+="&nbsp;",d=_.b.create("tr",d,[g("time"),b,g("message",e.text)]));this.a=d}}();function y(a){this.name=a.name;this.o=a.o||"";this.K=a.K||{};this.g=a.g||[]}y.prototype.q=function(a){this.Z([a])};y.prototype.Z=function(a){_(a).m(function(a){a.l&&(a.l.prefix=this.K[a.l.c]);this.g.push(a)},this);_(this).i("new-msgs",[[],a])};function z(a,e){_(e).forEach(function(d,e){a.K[e]=d})};function C(a){var e=_.b,e={j:e.create("li",["chan"],a.name),g:e.create("div",["log_container","is-selectable"],e.create("table",["log"],e.create("tbody")))},d=this,g=e.g,b=e.g.getElementsByTagName("tbody")[0];_(a.g).m(function(a){b.appendChild((new x(a)).a)});_(a).h("new-msgs",function(a,e){var k=g.scrollTop===g.scrollHeight-g.clientHeight;_(a).m(function(a){_.b.V(b,(new x(a)).a)},d);_(e).m(function(a){b.appendChild((new x(a)).a)},d);k&&(g.scrollTop=g.scrollHeight)});_(a).h("mentioned",function(){d.k||
d.aa()});_(a).h("removed",function(){_(d).i("removed")});_(a).h("new-topic",function(){d.k&&_.i("new-topic",[a])});e.j.onclick=function(){_.i("new-active-chan",[d]);d.s()};this.a=e;this.v=this.k=s;this.e=a}C.prototype.s=function(){_.b.D(this.a.j,"is-active");this.k=n;this.ga()};C.prototype.S=function(){_.b.Q(this.a.j,"is-active");this.k=s};C.prototype.aa=function(){_.b.D(this.a.j,"is-interesting");this.v=n};C.prototype.ga=function(){this.v&&(this.v=s,_.b.Q(this.a.j,"is-interesting"))};function D(a){var e=RegExp("\\b"+a.c+"\\b","i");this.name=a.name;this.d=a.d;this.c=a.c;this.X=e;this.f=a.f||[];this.K=a.K||[];this.I=a.I||new y({});this.G=function(a){var e=_.filter(this.f,function(b){return b.name===a});if(0<e.length)return e[0]};this.P=function(a){if(!_(this.f).wa(function(b){return b.name===a.name})){a.c=this.c;var e=new y(a);this.f.push(e);_(this).i("new-chan",[e]);return e}};this.Oa=function(a){var e=_(this.f),b=e.filter(function(b){return b.name===a});0<b.length&&(_(b[0]).i("removed"),
this.f=e.filter(function(b){b.name!==a}))}}function F(a,e){a.c=e;a.X=RegExp("\\b"+e+"\\b","i")}D.prototype.q=function(a){this.Z([a])};
D.prototype.Z=function(a){_(a).m(function(a){if(a.global)this.I.q(a);else if(a instanceof v){var d=_(this.f).find(function(b){return b.name===a.e});if(this.X.test(a.text)){_(d).i("mentioned");_(this).i("mentioned");a.v=n;var g=a.text.split(this.X),b=[],j=_.b.fa("span","mention",this.c);_.m(g,function(a){b.push(document.createTextNode(a));b.push(j())});b.pop();a.text=b}d&&d.q(a)}else return"Not a message."},this)};var G=function(){function a(a,d){var g=_.b,b={j:g.create("li",["serv"],d.name),f:g.create("ul",["chans"])};a.I=new C(d.I);g=_.map(d.f,function(b){return new C(b)});a.ha=g;_.m(g,function(a){b.f.appendChild(a.a.j)});0<g.length&&g[0].s();b.j.onclick=function(){a.k?_.i("new-active-chan",[a.I]):_.i("new-active-serv",[a])};a.a=b}return function(e){a(this,e);var d=this.ha,g=this.a,b=this;_(e).h("new-chan",function(b){var a=new C(b);0<d.length?(b=_.oa(d,function(b){return b.k}),d.splice(b+1,0,a),g.f.insertBefore(a.a.j,
g.f.childNodes[b].nextSibling)):(d.push(a),_.b.V(g.f,a.a.j),_.i("new-active-chan",[a]));_(a).h("removed",function(){g.f.removeChild(a.a.j);d=_(d).filter(function(b){return a!==b})})});_(e).h("mentioned",function(){b.k||b.aa()});this.C=e}}();G.prototype.t=function(){var a=_(this.ha).find(function(a){return a.k});return a?a:this.I};G.prototype.s=function(){_.b.D(this.a.j,"is-active");this.k=n;this.ga()};G.prototype.S=function(){_.b.Q(this.a.j,"is-active");this.k=s};
G.prototype.aa=function(){_.b.D(this.a.j,"is-interesting");this.v=n};G.prototype.ga=function(){this.v&&(this.v=s,_.b.Q(this.a.j,"is-interesting"))};function w(a){this.c=a;this.prefix=this.host=this.l=i};var Q=function(){var a=_.b.create,e=_.b.append;return function(){function d(b){13===b.keyCode&&f.value&&g()}function g(){App.join(H(View).C.d,f.value);View.ma()}var b=document.createDocumentFragment(),j=a("label",[],"chan");j["for"]="chan-name";var f=a("input",[],[],{type:"text",id:"chan-name",name:"chan-name",ia:n}),k=a("input",[],i,{type:"button",value:"Join"});e(b,[a("h1",[],"Join"),a("p",[],[j,f]),a("p",[],[k])]);this.a=a("div","modal",b);this.a.id="newChan";k.addEventListener?(this.a.addEventListener("click",
_.event.cancel),k.addEventListener("click",g),f.addEventListener("keydown",d)):(this.a.attachEvent("onclick",_.event.cancel),k.attachEvent("onclick",g),f.attachEvent("onkeydown",d));return this}}(),W=function(){var a=_.b.create,e=_.b.append;return function(){function d(){App.ra[f.value]=o.value;App.F.H.i("connect",{d:f.value,f:[],c:q.value});View.ma()}function g(b){this===f&&(o.value=V(f.value));13===b.keyCode&&f.value&&o.value&&q&&d()}var b=document.createDocumentFragment(),j=a("label",[],"Server");
j["for"]="serv-addr";var f=a("input",[],[],{type:"text",name:"addr",id:"serv-addr",ia:n}),k=a("label",[],"Name");j["for"]="serv-name";var o=a("input",[],[],{type:"text",name:"name",id:"serv-name"}),l=a("label",[],"Nick");l["for"]="serv-nick";var q=a("input",[],[],{name:"nick",id:"serv-nick"}),m=a("input",[],i,{type:"button",value:"Connect"});e(b,[a("h1",[],"Connect"),a("p",[],[j,f]),a("p",[],[k,o]),a("p",[],[l,q]),a("p",[],[m])]);j=[f,o,q];this.a=a("div","modal",b);this.a.id="newServ";this.a.addEventListener?
(this.a.addEventListener("click",_.event.cancel),_.forEach(j,function(b){b.addEventListener("keydown",g)}),m.addEventListener("click",d)):(this.a.attachEvent("onclick",_.event.cancel),_.forEach(j,function(b){b.attachEvent("onkeydown",g)}),m.attachEvent("onclick",d));return this}}();var X=function(){var a=_.b.create("ul");return function(){this.a={f:a}}}();(function(){var a=_.b.create("div");return function(){this.a={g:a}}})();X.prototype.t=function(){var a={a:{g:_.b.create("div")}};return function(){return a}}();X.prototype.S=function(){};X.prototype.s=function(){};function Y(a){var e=_.b,d={body:document.body,P:function(){var a=e.create("div","modal");a.id="chan_modal";return a}(),ca:function(){var a=e.create("div","modal");a.id="serv_modal";return a}()};this.W=[];a?(io.F.H.i("connect",{d:a+"/irc",f:[],c:i}),a={H:i}):a={};this.F=a;this.handle();this.a=d;this.va=function(a){if(!_.find(this.W,function(b){return b.d===a.d})){this.W.push(a);_(this).i("new-server",[a])}};this.A=function(a){a=_.filter(this.W,function(b){return b.d===a});if(a.length>0)return a[0]};
this.ra={}}function V(a){for(var e=0,d="",g="";e<a.length;){for(g="";e<a.length&&"."!==a[e];)g+=a[e],e++;for(g.length>d.length&&(d=g);e<a.length&&"."===a[e];)e++}return d}
Y.prototype.handle=function(){var a=this,e=this.F.H;e.h("registered",function(d){a.va(new D({name:a.ra[d.d]||V(d.d),d:d.d,c:d.c}))});e.h("join",function(d){var e=a.A(d.d),b=e.G(d.e);b||(b=e.P({name:d.e}));d.join=n;b.q(new v(d))});e.h("message",function(d){a.A(d.d).q(new v(d))});e.h("topic",function(d){var e=a.A(d.d).G(d.e);e.o={ea:d.o,c:d.c};_(e).i("new-topic")});e.h("quit",function(d){var e=a.A(d.d);d.Na=n;_.forEach(d.f,function(a){e.G(a).q(new v(d))})});e.h("part",function(d){var e=a.A(d.d);d.Ma=
n;d.c===e.c?e.Oa(d.e):e.G(d.e).q(new v(d))});e.h("names",function(d){z(a.A(d.d).G(d.e),d.ub)});e.h("disconnect",function(){_.i("disconnected",[])});e.h("nick",function(d){var e=a.A(d.d);e&&(e.c===d.qa&&F(e,d.c),_.forEach(d.f,function(a){(a=e.G(a))&&a.q(new v(d))}))})};Y.prototype.join=function(a,e){this.F.H.i("join",{d:a,e:e})};var Z=function(){function a(a,b){function j(d){if(d.keyCode===l.tab){var e=_.b.Aa(this),f=this.value.substring(0,e),k=/\w*?$/.exec(f),o=H(a).t().e.K,j=[];if(k){var A=k[0].toLowerCase();_.forEach(o,function(a,b){0===b.toLowerCase().indexOf(A)&&j.push(b)});j.sort();1===j.length?(this.value=f+j[0].substring(k[0].length,j[0].length)+this.value.substring(e,this.value.length)+": ",_.b.select(this,this.value.length)):1<j.length&&console.log(j)}_.event.cancel(d)}else d.keyCode===l.enter?(e=H(a),f=e.t(),d=
this.value,e={d:e.C.d,e:f.e.name,c:e.C.c},0===d.toLowerCase().indexOf("/me ")?(e.B=d.slice(4),b.F.H.i("action",e)):(e.B=d,b.F.H.i("say",e)),a.history.g.unshift(d),a.history.position=-1,this.value=""):d.keyCode===l.up?(e=++a.history.position,0===e&&(a.history.$=this.value),e<a.history.g.length?this.value=a.history.g[e]:a.history.position--,console.log("Selecting."),_.b.select(this),_.event.cancel(d)):d.keyCode===l.down&&(e=--a.history.position,-1===e?(this.value=a.history.$,a.history.$="",_.b.select(this,
this.value.length)):(this.value=a.history.g[e],console.log("Selecting."),_.b.select(this)),_.event.cancel(d))}var f={body:document.body,n:e.create("div"),Ja:new Q,Ka:new W,J:e.create("ul",["servs"]),ca:e.create("li",["serv","nonitem"],"+"),P:e.create("li",["chan","nonitem"],"+"),N:e.create("header",["connection-list"]),input:e.create("input",["chat","is-selectable"]),u:e.create("div")};f.body.appendChild(f.n);f.u.id="gradient";f.n.id="modal";f.input.ia=n;a.a=f;a.history={g:[],position:0,$:""};var k=
a.ma=function(){e.Q(f.n,"show");e.clear(f.n)};f.n.addEventListener?f.n.addEventListener("click",k,s):f.n.attachEvent("onclick",k);a.ua=new X;k=_.map(b.W,function(a){return new G(a)});0<k.length&&k[0].s();_.m(k,function(a){d(f.J,a.a.j)});f.J.appendChild(f.ca);a.Y=k;f.ca.onclick=function(){d(f.n,f.Ka.a);e.D(f.n,"show")};f.P.onclick=function(){d(f.n,f.Ja.a);e.D(f.n,"show")};var o=H(a);f.ya=o.a.f;d(f.N,[f.J,f.ya,f.u]);d(f.body,[f.N,o.t().a.g,f.input]);var l={tab:9,enter:13,up:38,down:40};f.input.addEventListener?
f.input.addEventListener("keydown",j,s):f.input.attachEvent("onkeydown",j);a.Y=k}var e=_.b,d=_.b.append;return function(e){a(this,e);var b=this.a,j=this,f=this.Y;_.h("new-active-chan",function(a){var d=H(j).t();d.S();a.s();b.body.replaceChild(a.a.g,d.a.g);a.a.g.style.bottom=b.input.offsetHeight+"px";a.a.g.style.top=b.N.offsetHeight+"px";b.u.innerHTML=a.e.o.ea;b.u.title="Set by "+a.e.o.c});_.h("new-topic",function(a){b.u.innerHTML=a.o.ea;b.u.title="Set by "+a.o.c});_.h("new-active-serv",function(a){var e=
H(j);e.S();a.s();var f=e.t(),g=a.t();b.body.replaceChild(g.a.g,f.a.g);b.N.replaceChild(a.a.f,e.a.f);d(a.a.f,b.P);g.a.g.style.bottom=b.input.offsetHeight+"px";g.a.g.style.top=b.N.offsetHeight+"px";b.u.innerHTML=g.e.o.ea;b.u.title="Set by "+g.e.o.c});_.h("disconnected",function(){H(j).t().e.q(new v({B:"Disconnected.",action:n,c:""}))});_(e).h("new-server",function(a){a=new G(a);if(0<f.length){var d=_.oa(f,function(a){return a.k===n});f.splice(d+1,0,a);b.J.insertBefore(a.a.j,b.J.childNodes[d+1])}else f.push(a),
_.b.V(b.J,a.a.j),_.i("new-active-serv",[a]),a.s()})}}();function H(a){var e=_.find(a.Y,function(a){return a.k});return e?e:a.ua};window.ta=new Y(":33111");window.Ta=new Z(window.ta);